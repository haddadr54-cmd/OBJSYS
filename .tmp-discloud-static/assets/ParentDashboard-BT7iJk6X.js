const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotasPage-Sczz-zki.js","assets/index-CCr23udO.js","assets/index-CKFdKx3N.css","assets/useRealtimeRecados-C7jbUtA1.js","assets/gradeConfig-C64ZX5y1.js","assets/ItemDetailModal-Dr1W76Xe.js","assets/LancarNotasModal-Cr1cCl9s.js","assets/save-BDGo1Gz5.js","assets/download-B2qXGiUz.js","assets/trash-2-IEheby2Z.js","assets/filter-ClytLayh.js","assets/x-circle-CouFZ83r.js","assets/square-pen-CFWfA0Dv.js","assets/AgendaPage-D-v1F4hW.js","assets/grid-3x3-BrVqK7_f.js","assets/MateriaisPage-DtYKdbWu.js","assets/upload-DIwgGHqY.js","assets/RecadosPage-CQT7GTjc.js","assets/globe-C0WZKshV.js","assets/PerfilPage-DsMAspKn.js","assets/camera-BEMhB8EQ.js","assets/NotificacoesPage-CG0CutsS.js","assets/refresh-cw-DeA23GkC.js","assets/archive-d9il3qmI.js","assets/info-frV-0ZWO.js"])))=>i.map(i=>d[i]);
import{u as le,r,j as e,X as xe,U as ee,B as K,C as Q,M as G,G as he,a as ge,P as pe,b as ue,T as re,c as be,F as ne,S as ie,d as fe,e as se,A as je,_ as k,f as Ne}from"./index-CCr23udO.js";import{I as ve}from"./ItemDetailModal-Dr1W76Xe.js";import{H as te,p as ye}from"./Header-BRx8hCSJ.js";import{MEDIA_MINIMA_APROVACAO as ae,formatarNota as Y,getNotaTextColor as we,getMediaGradientClasses as _e}from"./gradeConfig-C64ZX5y1.js";function De({isOpen:m,onClose:b,aluno:l,allNotas:h,allProvasTarefas:S,allRecados:g,allDisciplinas:v}){var B,P,L,w,D;const{isSupabaseConnected:j}=le(),[f,U]=r.useState("info"),[p,$]=r.useState([]),[T,q]=r.useState([]),[A,H]=r.useState([]),[E,I]=r.useState(!0);console.log("📋 [StudentProfileModal] Modal renderizado!",{aluno:l.nome,alunoId:l.id,turma:((B=l.turma)==null?void 0:B.nome)||"Turma não definida",responsavel:((P=l.responsavel)==null?void 0:P.nome)||"Responsável não definido",totalNotas:h.length,totalProvas:S.length,totalRecados:g.length,timestamp:new Date().toISOString()}),r.useEffect(()=>{m&&l&&J()},[m,l,h,S,g]);const J=()=>{var s;console.log("🔍 [StudentProfileModal] Filtrando dados do aluno:",{alunoId:l.id,turmaId:l.turma_id,totalNotasDisponiveis:h.length,totalProvasDisponiveis:S.length,totalRecadosDisponiveis:g.length}),console.log("� [StudentProfileModal] Verificando compatibilidade dos dados:",{totalNotas:h.length,alunoId:l.id,primeiraNotaAlunoId:(s=h[0])==null?void 0:s.aluno_id,matchExato:h.filter(a=>a.aluno_id===l.id).length}),I(!0);try{const a=h.filter(o=>(console.log("🔍 Comparando:",{nota_aluno_id:o.aluno_id,aluno_id:l.id,match:o.aluno_id===l.id}),o.aluno_id===l.id));console.log("📝 Notas filtradas:",a.length,a),$(a);const n=S.filter(o=>{var x;return j?((x=o.disciplina)==null?void 0:x.turma_id)===l.turma_id:o.turma_id===l.turma_id});console.log("📅 Provas/Tarefas filtradas:",n.length,n),q(n);const d=g.filter(o=>o.destinatario_tipo==="geral"||o.destinatario_tipo==="turma"&&o.destinatario_id===l.turma_id||o.destinatario_tipo==="aluno"&&o.destinatario_id===l.id);console.log("💬 Recados filtrados:",d.length,d),H(d)}catch(a){console.error("❌ Erro ao filtrar dados do aluno:",a)}finally{I(!1)}},F=()=>p.length===0?0:p.reduce((a,n)=>a+(n.nota||0),0)/p.length,W=s=>{const a=p.filter(d=>d.disciplina_id===s);return a.length===0?0:a.reduce((d,o)=>d+(o.nota||0),0)/a.length},C=s=>{const a=v.find(n=>n.id===s);return(a==null?void 0:a.nome)||"Disciplina não encontrada"},O=s=>{const a=v.find(n=>n.id===s);return(a==null?void 0:a.cor)||"#3B82F6"},V=()=>{const s=new Date().toISOString().split("T")[0];return T.filter(a=>(j?a.data:a.data_entrega)>=s).sort((a,n)=>{const d=j?a.data:a.data_entrega,o=j?n.data:n.data_entrega;return d.localeCompare(o)}).slice(0,5)},y=()=>A.sort((s,a)=>new Date(a.data_envio).getTime()-new Date(s.data_envio).getTime()).slice(0,5);return m?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl border-4 border-blue-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 relative",children:[e.jsx("button",{onClick:()=>{console.log("🔒 [StudentProfileModal] Botão fechar clicado"),b()},className:"absolute top-4 right-4 p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-all duration-300 z-[1001]",children:e.jsx(xe,{className:"h-6 w-6"})}),e.jsx("div",{className:"pr-16",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-white font-black text-2xl",children:l.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black",children:l.nome}),e.jsxs("p",{className:"text-blue-100",children:["Turma: ",((L=l.turma)==null?void 0:L.nome)||"Não definida"]}),e.jsxs("p",{className:"text-blue-100",children:["Responsável: ",((w=l.responsavel)==null?void 0:w.nome)||"Não definido"]})]})]})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"info",label:"Informações",icon:ee},{id:"notas",label:"Notas",icon:K},{id:"avaliacoes",label:"Avaliações",icon:Q},{id:"recados",label:"Recados",icon:G}].map(({id:s,label:a,icon:n})=>e.jsxs("button",{onClick:()=>U(s),className:`py-4 px-2 border-b-2 font-medium text-sm flex items-center space-x-2 transition-colors ${f===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:a})]},s))})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:E?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Carregando dados..."})]}):e.jsxs(e.Fragment,{children:[f==="info"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2 text-blue-600"}),"Informações Pessoais"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome Completo"}),e.jsx("p",{className:"text-gray-800 font-medium",children:l.nome})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Data de Nascimento"}),e.jsx("p",{className:"text-gray-800",children:l.data_nascimento||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"CPF"}),e.jsx("p",{className:"text-gray-800",children:l.cpf||"Não informado"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(he,{className:"h-5 w-5 mr-2 text-purple-600"}),"Informações Acadêmicas"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Turma"}),e.jsx("p",{className:"text-gray-800 font-medium",children:((D=l.turma)==null?void 0:D.nome)||"Não definida"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Matrícula"}),e.jsx("p",{className:"text-gray-800",children:l.matricula||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Média Geral"}),e.jsx("p",{className:"text-gray-800 font-bold text-lg",children:F().toFixed(1)})]})]})]})]}),l.responsavel&&e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(ge,{className:"h-5 w-5 mr-2 text-green-600"}),"Responsável"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome"}),e.jsx("p",{className:"text-gray-800 font-medium",children:l.responsavel.nome})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Telefone"}),e.jsxs("p",{className:"text-gray-800 flex items-center",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),l.responsavel.telefone||"Não informado"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsxs("p",{className:"text-gray-800 flex items-center",children:[e.jsx(ue,{className:"h-4 w-4 mr-1"}),l.responsavel.email||"Não informado"]})]})]})]})]}),f==="notas"&&e.jsx("div",{className:"space-y-6",children:p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Nenhuma nota encontrada"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2 text-blue-600"}),"Resumo Acadêmico"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-black text-blue-600",children:F().toFixed(1)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Média Geral"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-black text-purple-600",children:p.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total de Notas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-black text-green-600",children:p.filter(s=>(s.nota||0)>=ae).length}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Notas ≥ ",Y(ae)]})]})]})]}),e.jsx("div",{className:"space-y-4",children:Array.from(new Set(p.map(s=>s.disciplina_id))).map(s=>{const a=p.filter(x=>x.disciplina_id===s),n=W(s),d=C(s),o=O(s);return e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-bold text-gray-800 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:o}}),d]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-black",style:{color:o},children:n.toFixed(1)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Média"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(x=>{var M;return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:x.tipo||"Avaliação"}),e.jsx("span",{className:`text-lg font-bold ${we(x.nota||0)}`,children:((M=x.nota)==null?void 0:M.toFixed(1))||"0.0"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:x.data_lancamento?new Date(x.data_lancamento).toLocaleDateString("pt-BR"):"—"}),x.observacoes&&e.jsx("p",{className:"text-xs text-gray-600 mt-2 italic",children:x.observacoes})]},x.id)})})]},s)})})]})}),f==="avaliacoes"&&e.jsx("div",{className:"space-y-6",children:T.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Nenhuma avaliação encontrada"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(be,{className:"h-5 w-5 mr-2 text-orange-600"}),"Próximas Avaliações"]}),e.jsx("div",{className:"space-y-3",children:V().map(s=>{var d;const a=j?s.data:s.data_entrega,n=j?(d=s.disciplina)==null?void 0:d.nome:C(s.disciplina_id);return e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-xl p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:s.titulo}),e.jsx("p",{className:"text-sm text-gray-600",children:n})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-orange-600",children:new Date(a).toLocaleDateString("pt-BR")}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s.tipo})]})]},s.id)})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(ne,{className:"h-5 w-5 mr-2 text-blue-600"}),"Todas as Avaliações"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(s=>{var o,x;const a=j?s.data:s.data_entrega,n=j?(o=s.disciplina)==null?void 0:o.nome:C(s.disciplina_id),d=j?(x=s.disciplina)==null?void 0:x.cor:O(s.disciplina_id);return e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-1",children:s.titulo}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:d||"#3B82F6"}}),n]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.tipo==="prova"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:s.tipo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-medium",children:new Date(a).toLocaleDateString("pt-BR")})]}),s.valor&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Valor:"}),e.jsxs("span",{className:"font-medium",children:[s.valor," pontos"]})]})]}),s.descricao&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.descricao})})]},s.id)})})]})]})}),f==="recados"&&e.jsx("div",{className:"space-y-6",children:A.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Nenhum recado encontrado"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2 text-green-600"}),"Recados Recentes"]}),e.jsx("div",{className:"space-y-3",children:y().map(s=>{var a;return e.jsxs("div",{className:"bg-white rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-800",children:s.titulo}),e.jsxs("p",{className:"text-sm text-gray-600",children:["De: ",((a=s.remetente)==null?void 0:a.nome)||"Sistema"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.data_envio).toLocaleDateString("pt-BR")}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.destinatario_tipo==="geral"?"bg-blue-100 text-blue-800":s.destinatario_tipo==="turma"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"}`,children:s.destinatario_tipo==="geral"?"Geral":s.destinatario_tipo==="turma"?"Turma":"Individual"})]})]}),e.jsx("p",{className:"text-sm text-gray-700",children:s.conteudo})]},s.id)})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(G,{className:"h-5 w-5 mr-2 text-blue-600"}),"Todos os Recados"]}),e.jsx("div",{className:"space-y-4",children:A.map(s=>{var a;return e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-800 mb-2",children:s.titulo}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["De: ",((a=s.remetente)==null?void 0:a.nome)||"Sistema"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.data_envio).toLocaleDateString("pt-BR")})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.destinatario_tipo==="geral"?"bg-blue-100 text-blue-800":s.destinatario_tipo==="turma"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"}`,children:s.destinatario_tipo==="geral"?"Geral":s.destinatario_tipo==="turma"?"Turma":"Individual"})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.conteudo})}),s.anexos&&s.anexos.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Anexos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.anexos.map((n,d)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs text-gray-600",children:e.jsx("span",{children:n.nome||n.id||"Anexo"})},d))})]})]},s.id)})})]})]})})]})})]})}):null}const Se=r.lazy(()=>k(()=>import("./NotasPage-Sczz-zki.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])).then(m=>({default:m.NotasPage}))),Pe=r.lazy(()=>k(()=>import("./AgendaPage-D-v1F4hW.js"),__vite__mapDeps([13,1,2,5,4,7,14,10,12,9])).then(m=>({default:m.AgendaPage}))),Ae=r.lazy(()=>k(()=>import("./MateriaisPage-DtYKdbWu.js"),__vite__mapDeps([15,1,2,5,4,16,7,10,12,9])).then(m=>({default:m.MateriaisPage}))),ke=r.lazy(()=>k(()=>import("./RecadosPage-CQT7GTjc.js"),__vite__mapDeps([17,1,2,5,4,18,3,9,10,12])).then(m=>({default:m.RecadosPage}))),Te=r.lazy(()=>k(()=>import("./PerfilPage-DsMAspKn.js"),__vite__mapDeps([19,1,2,12,7,20])).then(m=>({default:m.PerfilPage}))),Ce=r.lazy(()=>k(()=>import("./NotificacoesPage-CG0CutsS.js"),__vite__mapDeps([21,1,2,22,5,4,9,10,23,24])).then(m=>({default:m.NotificacoesPage})));function Fe({onNavigate:m,currentPage:b="dashboard"}){const{user:l,isSupabaseConnected:h,signOut:S}=le(),g=fe(l,h),[v,j]=r.useState([]),[f,U]=r.useState([]),[p,$]=r.useState([]),[T,q]=r.useState([]),[A,H]=r.useState([]),[E,I]=r.useState([]),[J,F]=r.useState([]),[W,C]=r.useState(!0),[O,V]=r.useState(!1),[y,B]=r.useState(null),[P,L]=r.useState("prova_tarefa"),[w,D]=r.useState(!1),[s,a]=r.useState(null),n=r.useCallback(async()=>{confirm("Tem certeza que deseja sair do sistema?")&&await S()},[S]),d=r.useCallback(t=>{console.log("🔍 [ParentDashboard] handleNavigate chamado:",{pageId:t,currentPage:b,userType:l==null?void 0:l.tipo_usuario,timestamp:new Date().toISOString()}),t==="sair"?n():(console.log("🔍 [ParentDashboard] Chamando onNavigate com:",t),m==null||m(t)),D(!1)},[m,n]);r.useEffect(()=>{l&&o();const t=i=>{d(i.detail)};return window.addEventListener("navigate",t),()=>{window.removeEventListener("navigate",t)}},[l,h,d]);const o=async()=>{try{const[t,i,c,u,N,_]=await Promise.all([g.getAlunos(),g.getTurmas(),g.getNotas(),g.getProvasTarefas(),g.getRecados(),g.getDisciplinas()]);console.log("🏠 [ParentDashboard] Dados carregados:",{alunos:t.length,turmas:i.length,notas:c.length,provasTarefas:u.length,recados:N.length,disciplinas:_.length}),console.log("🏠 [ParentDashboard] Primeiro aluno:",t[0]),console.log("🏠 [ParentDashboard] Primeira nota:",c[0]),j(t),I(i),U(c);const z=new Date().toISOString().split("T")[0],oe=u.filter(R=>(h?R.data:R.data_entrega)>=z).sort((R,X)=>{const me=h?R.data:R.data_entrega,ce=h?X.data:X.data_entrega;return me.localeCompare(ce)});$(oe),q(u),H(N),F(_)}catch(t){console.error("Erro ao carregar dashboard:",t)}finally{C(!1)}},x=async(t,i)=>{try{await Ne(i,t.id)}catch(c){console.error("Erro ao registrar visualização:",c)}B(t),L(i),V(!0)},[M,Z]=r.useState(!1),de=t=>{var i;console.log("🎓 [ParentDashboard] Card do aluno clicado!",{aluno:t.nome,alunoId:t.id,turma:(i=t.turma)==null?void 0:i.nome,timestamp:new Date().toISOString()}),a(t),Z(!0)};return b!=="dashboard"?e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[e.jsx(se,{currentPage:b,onPageChange:d,isOpen:w,onToggle:()=>D(!w)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(te,{onMenuToggle:()=>D(!w),title:ye[b]||"Portal do Responsável"}),e.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-4 sm:p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto mobile-container",children:e.jsxs(r.Suspense,{fallback:e.jsx("div",{className:"py-10 text-center text-gray-500 font-medium",children:"Carregando página..."}),children:[b==="notas"&&e.jsx(Se,{}),b==="agenda"&&e.jsx(Pe,{}),b==="materiais"&&e.jsx(Ae,{}),b==="recados"&&e.jsx(ke,{}),b==="notificacoes"&&e.jsx(Ce,{}),b==="perfil"&&e.jsx(Te,{})]})})})]})]}):W?e.jsx("div",{className:"min-h-screen layout-modern flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-large mx-auto mb-8 animate-glow"}),e.jsx("p",{className:"text-2xl font-black text-gray-700 animate-pulse",children:"Carregando informações..."}),e.jsx("p",{className:"text-lg text-gray-500 mt-4 font-semibold",children:"Aguarde um momento"})]})}):e.jsxs("div",{className:"flex h-screen layout-modern overflow-hidden",children:[e.jsx(se,{currentPage:b,onPageChange:d,isOpen:w,onToggle:()=>D(!w)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(te,{onMenuToggle:()=>D(!w),title:"Portal do Responsável"}),e.jsx("main",{className:"content-modern",children:e.jsxs("div",{className:"mobile-container space-y-6 sm:space-y-8 lg:space-y-12",children:[e.jsx("div",{className:"glass-card rounded-2xl sm:rounded-3xl mobile-card animate-slide-in-up hover-lift",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"mobile-heading heading-modern animate-glow",children:["Olá, ",l==null?void 0:l.nome.split(" ")[0],"! 👋"]}),e.jsx("p",{className:"text-gray-600 mt-2 sm:mt-4 text-base sm:text-xl font-semibold subheading-modern",children:"Acompanhe o desenvolvimento acadêmico dos seus filhos"})]}),e.jsx("div",{className:"flex items-center justify-center sm:justify-end",children:e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 px-4 sm:px-6 py-3 sm:py-4 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl sm:rounded-3xl text-sm sm:text-base font-black shadow-modern animate-bounce-soft status-online",children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 bg-white rounded-full animate-pulse shadow-lg"}),e.jsx("span",{className:"hidden sm:inline",children:"Online"}),e.jsx("span",{className:"sm:hidden",children:"✓"})]})})]})}),v.length>0&&e.jsxs("div",{className:"glass-card rounded-2xl sm:rounded-3xl mobile-card animate-slide-in-up delay-100",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-black text-gradient-objetivo mb-6 sm:mb-8 lg:mb-12 flex items-center",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl sm:rounded-2xl shadow-modern mr-3 sm:mr-6 animate-bounce-soft",children:e.jsx(ie,{className:"h-6 w-6 sm:h-8 sm:w-8 lg:h-10 lg:w-10 text-white"})}),"⭐ Resumo dos Seus Filhos"]}),e.jsx("div",{className:"mobile-grid",children:v.map(t=>{var i,c;return e.jsxs("div",{className:"card-modern mobile-card bg-gradient-to-br from-blue-50 via-indigo-100 to-purple-100 border-2 border-blue-300 hover:border-blue-500 animate-scale-in cursor-pointer select-none",onClick:()=>de(t),style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-2xl sm:rounded-3xl flex items-center justify-center text-white font-black text-xl sm:text-2xl lg:text-3xl shadow-modern-colored animate-float mx-auto sm:mx-0",children:t.nome.charAt(0).toUpperCase()}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-black text-gray-900",children:t.nome}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-700 font-bold",children:["🏫 ",(i=t.turma)==null?void 0:i.nome]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 font-semibold",children:["📅 ",(c=t.turma)==null?void 0:c.ano_letivo]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 sm:pt-6 border-t-2 border-blue-300",children:[e.jsx("span",{className:"text-sm sm:text-base font-black text-gray-800 whitespace-nowrap",children:"📊 Média Geral:"}),e.jsx("div",{className:`px-4 sm:px-6 py-3 sm:py-4 rounded-2xl sm:rounded-3xl font-black text-lg sm:text-xl lg:text-2xl shadow-modern animate-glow ${_e(g.calcularMediaAluno(t.id,f))}`,children:Y(g.calcularMediaAluno(t.id,f))})]})]},t.id)})})]}),e.jsxs("div",{className:"mobile-grid",children:[e.jsxs("button",{onClick:()=>d("notas"),className:"card-modern group mobile-card bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 border-2 border-blue-200 hover:border-blue-400 text-left animate-scale-in delay-100",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"p-3 sm:p-4 lg:p-5 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl sm:rounded-3xl text-white group-hover:scale-125 group-hover:rotate-12 transition-all duration-500 shadow-modern-colored mx-auto sm:mx-0",children:e.jsx(K,{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-black text-blue-900",children:"Notas"}),e.jsx("p",{className:"text-sm sm:text-base text-blue-700 font-bold",children:"Boletim escolar"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-black text-blue-600 animate-glow",children:f.length}),e.jsxs("span",{className:"text-xs sm:text-sm text-blue-600 opacity-0 group-hover:opacity-100 transition-all duration-300 font-black bg-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl sm:rounded-2xl shadow-lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Ver boletim →"}),e.jsx("span",{className:"sm:hidden",children:"Ver →"})]})]})]}),e.jsxs("button",{onClick:()=>d("agenda"),className:"card-modern group mobile-card bg-gradient-to-br from-amber-50 to-amber-100 hover:from-amber-100 hover:to-amber-200 border-2 border-amber-200 hover:border-amber-400 text-left animate-scale-in delay-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"p-3 sm:p-4 lg:p-5 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl sm:rounded-3xl text-white group-hover:scale-125 group-hover:rotate-12 transition-all duration-500 shadow-modern-colored mx-auto sm:mx-0",children:e.jsx(Q,{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-black text-amber-900",children:"Agenda"}),e.jsx("p",{className:"text-sm sm:text-base text-amber-700 font-bold",children:"Provas e tarefas"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-black text-amber-600 animate-glow",children:p.length}),e.jsxs("span",{className:"text-xs sm:text-sm text-amber-600 opacity-0 group-hover:opacity-100 transition-all duration-300 font-black bg-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl sm:rounded-2xl shadow-lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Ver agenda →"}),e.jsx("span",{className:"sm:hidden",children:"Ver →"})]})]})]}),e.jsxs("button",{onClick:()=>d("materiais"),className:"card-modern group mobile-card bg-gradient-to-br from-emerald-50 to-emerald-100 hover:from-emerald-100 hover:to-emerald-200 border-2 border-emerald-200 hover:border-emerald-400 text-left animate-scale-in delay-300",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"p-3 sm:p-4 lg:p-5 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl sm:rounded-3xl text-white group-hover:scale-125 group-hover:rotate-12 transition-all duration-500 shadow-modern-colored mx-auto sm:mx-0",children:e.jsx(ne,{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-black text-emerald-900",children:"Materiais"}),e.jsx("p",{className:"text-sm sm:text-base text-emerald-700 font-bold",children:"Recursos didáticos"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg sm:text-2xl font-black text-emerald-600 animate-glow",children:"Disponível"}),e.jsxs("span",{className:"text-xs sm:text-sm text-emerald-600 opacity-0 group-hover:opacity-100 transition-all duration-300 font-black bg-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl sm:rounded-2xl shadow-lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Ver materiais →"}),e.jsx("span",{className:"sm:hidden",children:"Ver →"})]})]})]}),e.jsxs("button",{onClick:()=>d("recados"),className:"card-modern group mobile-card bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 border-2 border-purple-200 hover:border-purple-400 text-left animate-scale-in delay-400",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"p-3 sm:p-4 lg:p-5 bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl sm:rounded-3xl text-white group-hover:scale-125 group-hover:rotate-12 transition-all duration-500 shadow-modern-colored mx-auto sm:mx-0",children:e.jsx(G,{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-black text-purple-900",children:"Recados"}),e.jsx("p",{className:"text-sm sm:text-base text-purple-700 font-bold",children:"Comunicados"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-black text-purple-600 animate-glow",children:A.length}),e.jsxs("span",{className:"text-xs sm:text-sm text-purple-600 opacity-0 group-hover:opacity-100 transition-all duration-300 font-black bg-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl sm:rounded-2xl shadow-lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Ver recados →"}),e.jsx("span",{className:"sm:hidden",children:"Ver →"})]})]})]})]}),p.length>0&&e.jsxs("div",{className:"glass-card rounded-2xl sm:rounded-3xl mobile-card bg-gradient-to-br from-amber-50 to-orange-100 border-2 border-amber-200 animate-slide-in-up delay-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-6 sm:mb-8",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl sm:rounded-2xl shadow-modern animate-bounce-soft mx-auto sm:mx-0",children:e.jsx(je,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-black text-amber-900",children:"⚠️ Próximas Avaliações"}),e.jsx("p",{className:"text-amber-700 font-bold text-sm sm:text-base lg:text-lg",children:"Fique atento às datas importantes"})]})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:p.slice(0,3).map(t=>{var z;const i=h?t.data:t.data_entrega,c=new Date().toISOString().split("T")[0],u=i===c,N=new Date(i).getTime()-new Date(c).getTime(),_=Math.ceil(N/(1e3*60*60*24));return e.jsx("div",{className:"card-modern p-4 sm:p-6 bg-white border-2 border-amber-200 hover:border-amber-400 cursor-pointer interactive-modern",onClick:()=>x(t,"prova_tarefa"),children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 text-base sm:text-lg",children:t.titulo}),e.jsx("p",{className:"text-gray-600 font-semibold text-sm sm:text-base",children:(z=t.disciplina)==null?void 0:z.nome})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("div",{className:`px-4 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl text-sm sm:text-base font-black shadow-lg animate-pulse ${u?"bg-red-500 text-white animate-pulse":_<=3?"bg-amber-500 text-white":"bg-green-500 text-white"}`,children:u?"🔔 HOJE":`${_} dias`}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 sm:mt-2 font-semibold",children:new Date(i).toLocaleDateString("pt-BR")})]})]})},t.id)})})]}),e.jsxs("div",{className:"glass-card rounded-2xl sm:rounded-3xl mobile-card animate-slide-in-up delay-300",children:[e.jsxs("h2",{className:"text-lg sm:text-xl lg:text-2xl font-black text-gray-900 mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl sm:rounded-2xl shadow-modern mr-0 sm:mr-4 animate-bounce-soft mx-auto sm:mx-0",children:e.jsx(re,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),e.jsx("span",{className:"text-center sm:text-left",children:"Resumo Geral"})]}),e.jsxs("div",{className:"mobile-stats-grid",children:[e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl sm:rounded-2xl hover-lift",children:[e.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-black text-blue-600 mb-2 sm:mb-3 animate-glow",children:v.length}),e.jsx("div",{className:"text-xs sm:text-sm lg:text-base font-bold text-blue-800",children:"👨‍👩‍👧‍👦 Filhos"})]}),e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl sm:rounded-2xl hover-lift",children:[e.jsx("span",{className:"text-2xl sm:text-3xl lg:text-4xl font-black text-emerald-600 mb-2 sm:mb-3 animate-glow",children:f.length}),e.jsx("div",{className:"text-xs sm:text-sm lg:text-base font-bold text-emerald-800",children:"📝 Notas"})]}),e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl sm:rounded-2xl hover-lift",children:[e.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-black text-amber-600 mb-2 sm:mb-3 animate-glow",children:p.length}),e.jsx("div",{className:"text-xs sm:text-sm lg:text-base font-bold text-amber-800",children:"📅 Próximas Provas"})]}),e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl sm:rounded-2xl hover-lift",children:[e.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-black text-purple-600 mb-2 sm:mb-3 animate-glow",children:v.length>0?Y(v.reduce((t,i)=>t+g.calcularMediaAluno(i.id,f),0)/v.length):"0.0"}),e.jsx("div",{className:"text-xs sm:text-sm lg:text-base font-bold text-purple-800",children:"📊 Média Geral"})]})]})]})]})})]}),e.jsx(ve,{isOpen:O,onClose:()=>V(!1),item:y,type:P,turmaName:P==="prova_tarefa"&&y?(()=>{var i,c;const t=y;if(h)return(i=E.find(u=>{var N;return u.id===((N=t.disciplina)==null?void 0:N.turma_id)}))==null?void 0:i.nome;{const{localDB:u}=require("../../lib/localDatabase");return(c=u.getTurmas().find(N=>N.id===t.turma_id))==null?void 0:c.nome}})():void 0,disciplinaName:P==="prova_tarefa"&&y?(()=>{var i,c;const t=y;if(h)return(i=t.disciplina)==null?void 0:i.nome;{const{localDB:u}=require("../../lib/localDatabase");return(c=u.getDisciplinas().find(_=>_.id===t.disciplina_id))==null?void 0:c.nome}})():void 0,autorName:P==="recado"&&y?(()=>{var i,c;const t=y;if(h)return(i=t.autor)==null?void 0:i.nome;{const{localDB:u}=require("../../lib/localDatabase");return(c=u.getUsuarios().find(_=>_.id===t.autor_id))==null?void 0:c.nome}})():void 0}),s&&M&&e.jsx(De,{isOpen:M,onClose:()=>{console.log("🔒 [ParentDashboard] Fechando modal do perfil do aluno"),Z(!1),a(null)},aluno:s,allNotas:f,allProvasTarefas:T,allRecados:A,_allTurmas:E,allDisciplinas:J})]})}export{Fe as ParentDashboard};
