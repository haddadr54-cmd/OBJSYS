import{r as p,j as e,i as E,F as L,C as U,s as g,a as T,v as k,E as R,l as w,A as N,D as _,ap as I,c as O}from"./index-CCr23udO.js";import{D as P}from"./download-B2qXGiUz.js";import{X as f}from"./x-circle-CouFZ83r.js";import{F as M}from"./filter-ClytLayh.js";import{A as B}from"./activity-BhR_JPLz.js";import{S as F}from"./square-pen-CFWfA0Dv.js";function X(){const[i,$]=p.useState([{id:"1",timestamp:new Date().toISOString(),user:"Carlos Oliveira",action:"LOGIN",resource:"Sistema",details:"Login realizado com sucesso",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",status:"success",category:"auth"},{id:"2",timestamp:new Date(Date.now()-3e5).toISOString(),user:"Maria Santos",action:"CREATE_STUDENT",resource:"Alunos",details:"Novo aluno cadastrado: Jo√£o Silva",ip:"192.168.1.101",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)",status:"success",category:"crud"},{id:"3",timestamp:new Date(Date.now()-9e5).toISOString(),user:"Jo√£o Silva",action:"FAILED_LOGIN",resource:"Sistema",details:"Tentativa de login com credenciais inv√°lidas",ip:"192.168.1.102",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_7_1 like Mac OS X)",status:"error",category:"security"},{id:"4",timestamp:new Date(Date.now()-18e5).toISOString(),user:"Sistema",action:"AUTO_BACKUP",resource:"Banco de Dados",details:"Backup autom√°tico executado com sucesso",ip:"localhost",userAgent:"Sistema Interno",status:"success",category:"system"},{id:"5",timestamp:new Date(Date.now()-27e5).toISOString(),user:"Ana Costa",action:"UPDATE_GRADE",resource:"Notas",details:"Nota atualizada para aluno Pedro Santos - Matem√°tica: 8.5",ip:"192.168.1.103",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",status:"success",category:"crud"}]),[t,u]=p.useState({busca:"",categoria:"",status:"",usuario:"",periodo:"hoje"}),[x,y]=p.useState({totalLogs:0,todayLogs:0,successRate:0,errorCount:0,uniqueUsers:0,topActions:[]});p.useEffect(()=>{v()},[i]);const v=()=>{const s=new Date().toDateString(),c=i.filter(r=>new Date(r.timestamp).toDateString()===s),o=i.filter(r=>r.status==="success").length,d=i.filter(r=>r.status==="error").length,a=new Set(i.map(r=>r.user)).size,n={};i.forEach(r=>{n[r.action]=(n[r.action]||0)+1});const m=Object.entries(n).sort(([,r],[,l])=>l-r).slice(0,5).map(([r,l])=>({action:r,count:l}));y({totalLogs:i.length,todayLogs:c.length,successRate:i.length>0?o/i.length*100:0,errorCount:d,uniqueUsers:a,topActions:m})},h=i.filter(s=>{const c=!t.busca||s.user.toLowerCase().includes(t.busca.toLowerCase())||s.action.toLowerCase().includes(t.busca.toLowerCase())||s.details.toLowerCase().includes(t.busca.toLowerCase()),o=!t.categoria||s.category===t.categoria,d=!t.status||s.status===t.status,a=!t.usuario||s.user===t.usuario;let n=!0;if(t.periodo!=="todos"){const m=new Date(s.timestamp),r=new Date;if(t.periodo==="hoje")n=m.toDateString()===r.toDateString();else if(t.periodo==="semana"){const l=new Date;l.setDate(r.getDate()-7),n=m>=l}else if(t.periodo==="mes"){const l=new Date;l.setMonth(r.getMonth()-1),n=m>=l}}return c&&o&&d&&a&&n}),A=()=>{const s=["Data,Usu√°rio,A√ß√£o,Recurso,Detalhes,IP,Status,Categoria",...h.map(a=>`"${new Date(a.timestamp).toLocaleString("pt-BR")}","${a.user}","${a.action}","${a.resource}","${a.details}","${a.ip}","${a.status}","${a.category}"`)].join(`
`),c=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),d=URL.createObjectURL(c);o.setAttribute("href",d),o.setAttribute("download",`auditoria_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},S=s=>{switch(s){case"success":return e.jsx(g,{className:"h-4 w-4 text-green-600"});case"error":return e.jsx(f,{className:"h-4 w-4 text-red-600"});case"warning":return e.jsx(N,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(O,{className:"h-4 w-4 text-gray-600"})}},D=s=>{switch(s){case"success":return"bg-green-100 text-green-800";case"error":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},j=s=>{switch(s){case"auth":return e.jsx(I,{className:"h-4 w-4"});case"crud":return e.jsx(F,{className:"h-4 w-4"});case"system":return e.jsx(_,{className:"h-4 w-4"});case"security":return e.jsx(w,{className:"h-4 w-4"});default:return e.jsx(B,{className:"h-4 w-4"})}},C=s=>{switch(s){case"auth":return"Autentica√ß√£o";case"crud":return"Dados";case"system":return"Sistema";case"security":return"Seguran√ßa";default:return s}},b=s=>({LOGIN:"Login",LOGOUT:"Logout",FAILED_LOGIN:"Login Falhado",CREATE_STUDENT:"Criar Aluno",UPDATE_STUDENT:"Atualizar Aluno",DELETE_STUDENT:"Excluir Aluno",CREATE_USER:"Criar Usu√°rio",UPDATE_USER:"Atualizar Usu√°rio",DELETE_USER:"Excluir Usu√°rio",CREATE_GRADE:"Criar Nota",UPDATE_GRADE:"Atualizar Nota",AUTO_BACKUP:"Backup Autom√°tico",MANUAL_BACKUP:"Backup Manual",SYSTEM_UPDATE:"Atualiza√ß√£o do Sistema"})[s]||s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-red-500 to-pink-600 rounded-xl shadow-lg",children:e.jsx(E,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent",children:"üìä Auditoria e Logs"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Monitoramento e an√°lise de atividades"})]})]}),e.jsxs("button",{onClick:A,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:"Exportar Logs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl border-2 border-blue-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-blue-600 uppercase tracking-wide",children:"üìä Total"}),e.jsx("p",{className:"text-3xl font-black text-blue-700",children:x.totalLogs})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:e.jsx(L,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-green-50 rounded-2xl shadow-xl border-2 border-green-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-green-600 uppercase tracking-wide",children:"üìÖ Hoje"}),e.jsx("p",{className:"text-3xl font-black text-green-700",children:x.todayLogs})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl shadow-lg",children:e.jsx(U,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-purple-50 rounded-2xl shadow-xl border-2 border-purple-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-purple-600 uppercase tracking-wide",children:"‚úÖ Taxa"}),e.jsxs("p",{className:"text-3xl font-black text-purple-700",children:[x.successRate.toFixed(1),"%"]})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl shadow-lg",children:e.jsx(g,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-red-50 rounded-2xl shadow-xl border-2 border-red-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-red-600 uppercase tracking-wide",children:"‚ùå Erros"}),e.jsx("p",{className:"text-3xl font-black text-red-700",children:x.errorCount})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-red-400 to-red-600 rounded-2xl shadow-lg",children:e.jsx(f,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-yellow-50 rounded-2xl shadow-xl border-2 border-yellow-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-yellow-600 uppercase tracking-wide",children:"üë• Usu√°rios"}),e.jsx("p",{className:"text-3xl font-black text-yellow-700",children:x.uniqueUsers})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-2xl shadow-lg",children:e.jsx(T,{className:"h-8 w-8 text-white"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(M,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Filtros de Auditoria"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar logs...",value:t.busca,onChange:s=>u({...t,busca:s.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:t.categoria,onChange:s=>u({...t,categoria:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),e.jsx("option",{value:"auth",children:"Autentica√ß√£o"}),e.jsx("option",{value:"crud",children:"Dados"}),e.jsx("option",{value:"system",children:"Sistema"}),e.jsx("option",{value:"security",children:"Seguran√ßa"})]}),e.jsxs("select",{value:t.status,onChange:s=>u({...t,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"success",children:"Sucesso"}),e.jsx("option",{value:"error",children:"Erro"}),e.jsx("option",{value:"warning",children:"Aviso"})]}),e.jsxs("select",{value:t.usuario,onChange:s=>u({...t,usuario:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os usu√°rios"}),[...new Set(i.map(s=>s.user))].map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:t.periodo,onChange:s=>u({...t,periodo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"hoje",children:"Hoje"}),e.jsx("option",{value:"semana",children:"Esta semana"}),e.jsx("option",{value:"mes",children:"Este m√™s"}),e.jsx("option",{value:"todos",children:"Todos"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üî• A√ß√µes Mais Frequentes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:x.topActions.map((s,c)=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.count}),e.jsx("div",{className:"text-sm text-gray-700",children:b(s.action)})]},s.action))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Logs de Auditoria (",h.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usu√°rio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A√ß√£o"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recurso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum log encontrado com os filtros aplicados"})}):h.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.timestamp).toLocaleString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-semibold mr-3",children:s.user.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.user})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1 bg-gray-100 rounded",children:j(s.category)}),e.jsx("span",{className:"text-sm text-gray-900",children:b(s.action)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.resource}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:`flex items-center space-x-2 px-2 py-1 rounded-full text-xs ${D(s.status)}`,children:[S(s.status),e.jsx("span",{className:"font-medium",children:s.status==="success"?"Sucesso":s.status==="error"?"Erro":"Aviso"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.ip}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>alert(`Detalhes:

${s.details}

User Agent: ${s.userAgent}`),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Ver detalhes",children:e.jsx(R,{className:"h-4 w-4"})})})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(w,{className:"h-6 w-6 text-red-600"}),e.jsx("h3",{className:"text-lg font-semibold text-red-900",children:"üö® Alertas de Seguran√ßa"})]}),e.jsx("div",{className:"space-y-3",children:i.filter(s=>s.status==="error"&&s.category==="security").length>0?i.filter(s=>s.status==="error"&&s.category==="security").slice(0,3).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(N,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:s.details}),e.jsxs("p",{className:"text-xs text-red-700",children:[s.user," - ",new Date(s.timestamp).toLocaleString("pt-BR")]})]})]}),e.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["IP: ",s.ip]})]},s.id)):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(g,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-green-700 font-medium",children:"Nenhum alerta de seguran√ßa"}),e.jsx("p",{className:"text-sm text-green-600",children:"Sistema funcionando normalmente"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìà Resumo por Categoria"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["auth","crud","system","security"].map(s=>{const c=i.filter(a=>a.category===s),o=c.filter(a=>a.status==="success").length,d=c.filter(a=>a.status==="error").length;return e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[j(s),e.jsx("span",{className:"ml-2 font-medium text-gray-900",children:C(s)})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:c.length}),e.jsxs("div",{className:"text-xs text-gray-600",children:[o," sucessos, ",d," erros"]})]},s)})})]})]})}export{X as AuditoriaPage};
