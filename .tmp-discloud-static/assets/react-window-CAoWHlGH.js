import{r as c,j as J}from"./index-CCr23udO.js";function re(e){let t=e;for(;t;){if(t.dir)return t.dir==="rtl";t=t.parentElement}return!1}function le(e,t){const[i,n]=c.useState(t==="rtl");return c.useLayoutEffect(()=>{e&&(t||n(re(e)))},[t,e]),i}const Y=typeof window<"u"?c.useLayoutEffect:c.useEffect;function K(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function ce({box:e,defaultHeight:t,defaultWidth:i,disabled:n,element:r,mode:o,style:s}){const{styleHeight:d,styleWidth:a}=c.useMemo(()=>({styleHeight:K(s==null?void 0:s.height),styleWidth:K(s==null?void 0:s.width)}),[s==null?void 0:s.height,s==null?void 0:s.width]),[f,u]=c.useState({height:t,width:i}),p=n||o==="only-height"&&d!==void 0||o==="only-width"&&a!==void 0||d!==void 0&&a!==void 0;return Y(()=>{if(r===null||p)return;const w=new ResizeObserver(C=>{for(const R of C){const{contentRect:z,target:m}=R;r===m&&u(I=>I.height===z.height&&I.width===z.width?I:{height:z.height,width:z.width})}});return w.observe(r,{box:e}),()=>{w==null||w.unobserve(r)}},[e,p,r,d,a]),c.useMemo(()=>({height:d??f.height,width:a??f.width}),[f,d,a])}function ae(e){const t=c.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return Y(()=>{t.current=e},[e]),c.useCallback(i=>{var n;return(n=t.current)==null?void 0:n.call(t,i)},[t])}let P=null;function de(e=!1){if(P===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?P="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?P="negative":P="positive-ascending"),document.body.removeChild(t),P}return P}function D({containerElement:e,direction:t,isRtl:i,scrollOffset:n}){if(t==="horizontal"&&i)switch(de()){case"negative":return-n;case"positive-descending":{if(e){const{clientWidth:r,scrollLeft:o,scrollWidth:s}=e;return s-r-o}break}}return n}function A(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function N(e,t){if(e===t)return!0;if(!!e!=!!t||(A(e!==void 0),A(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const i in e)if(!Object.is(t[i],e[i]))return!1;return!0}function ee({cachedBounds:e,itemCount:t,itemSize:i}){if(t===0)return 0;if(typeof i=="number")return t*i;{const n=e.get(e.size===0?0:e.size-1);A(n!==void 0,"Unexpected bounds cache miss");const r=(n.scrollOffset+n.size)/e.size;return t*r}}function ue({align:e,cachedBounds:t,index:i,itemCount:n,itemSize:r,containerScrollOffset:o,containerSize:s}){const d=ee({cachedBounds:t,itemCount:n,itemSize:r}),a=t.get(i),f=Math.max(0,Math.min(d-s,a.scrollOffset)),u=Math.max(0,a.scrollOffset-s+a.size);switch(e==="smart"&&(o>=u&&o<=f?e="auto":e="center"),e){case"start":return f;case"end":return u;case"center":return a.scrollOffset<=s/2?0:a.scrollOffset+a.size/2>=d-s/2?d-s:a.scrollOffset+a.size/2-s/2;case"auto":default:return o>=u&&o<=f?o:o<u?u:f}}function _({cachedBounds:e,containerScrollOffset:t,containerSize:i,itemCount:n,overscanCount:r}){const o=n-1;let s=0,d=-1,a=0,f=-1,u=0;for(;u<o;){const p=e.get(u);if(p.scrollOffset+p.size>t)break;u++}for(s=u,a=Math.max(0,s-r);u<o;){const p=e.get(u);if(p.scrollOffset+p.size>=t+i)break;u++}return d=Math.min(o,u),f=Math.min(n-1,d+r),s<0&&(s=0,d=-1,a=0,f=-1),{startIndexVisible:s,stopIndexVisible:d,startIndexOverscan:a,stopIndexOverscan:f}}function fe({itemCount:e,itemProps:t,itemSize:i}){const n=new Map;return{get(r){for(A(r<e,`Invalid index ${r}`);n.size-1<r;){const s=n.size;let d;switch(typeof i){case"function":{d=i(s,t);break}case"number":{d=i;break}}if(s===0)n.set(s,{size:d,scrollOffset:0});else{const a=n.get(s-1);A(a!==void 0,`Unexpected bounds cache miss for index ${r}`),n.set(s,{scrollOffset:a.scrollOffset+a.size,size:d})}}const o=n.get(r);return A(o!==void 0,`Unexpected bounds cache miss for index ${r}`),o},set(r,o){n.set(r,o)},get size(){return n.size}}}function he({itemCount:e,itemProps:t,itemSize:i}){return c.useMemo(()=>fe({itemCount:e,itemProps:t,itemSize:i}),[e,t,i])}function me({containerSize:e,itemSize:t}){let i;switch(typeof t){case"string":{A(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),A(e!==void 0,"Container size must be defined if a percentage item size is specified"),i=e*parseInt(t)/100;break}default:{i=t;break}}return i}function Q({containerElement:e,containerStyle:t,defaultContainerSize:i=0,direction:n,isRtl:r=!1,itemCount:o,itemProps:s,itemSize:d,onResize:a,overscanCount:f}){const[u,p]=c.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:w,startIndexOverscan:C,stopIndexVisible:R,stopIndexOverscan:z}={startIndexVisible:Math.min(o-1,u.startIndexVisible),startIndexOverscan:Math.min(o-1,u.startIndexOverscan),stopIndexVisible:Math.min(o-1,u.stopIndexVisible),stopIndexOverscan:Math.min(o-1,u.stopIndexOverscan)},{height:m=i,width:I=i}=ce({defaultHeight:n==="vertical"?i:void 0,defaultWidth:n==="horizontal"?i:void 0,element:e,mode:n==="vertical"?"only-height":"only-width",style:t}),T=c.useRef({height:0,width:0}),O=n==="vertical"?m:I,l=me({containerSize:O,itemSize:d});c.useLayoutEffect(()=>{if(typeof a=="function"){const h=T.current;(h.height!==m||h.width!==I)&&(a({height:m,width:I},{...h}),h.height=m,h.width=I)}},[m,a,I]);const v=he({itemCount:o,itemProps:s,itemSize:l}),y=c.useCallback(h=>v.get(h),[v]),E=c.useCallback(()=>ee({cachedBounds:v,itemCount:o,itemSize:l}),[v,o,l]),V=c.useCallback(h=>{const g=D({containerElement:e,direction:n,isRtl:r,scrollOffset:h});return _({cachedBounds:v,containerScrollOffset:g,containerSize:O,itemCount:o,overscanCount:f})},[v,e,O,n,r,o,f]);Y(()=>{const h=(n==="vertical"?e==null?void 0:e.scrollTop:e==null?void 0:e.scrollLeft)??0;p(V(h))},[e,n,V]),Y(()=>{if(!e)return;const h=()=>{p(g=>{const{scrollLeft:x,scrollTop:b}=e,k=D({containerElement:e,direction:n,isRtl:r,scrollOffset:n==="vertical"?b:x}),U=_({cachedBounds:v,containerScrollOffset:k,containerSize:O,itemCount:o,overscanCount:f});return N(U,g)?g:U})};return e.addEventListener("scroll",h),()=>{e.removeEventListener("scroll",h)}},[v,e,O,n,o,f]);const M=ae(({align:h="auto",containerScrollOffset:g,index:x})=>{let b=ue({align:h,cachedBounds:v,containerScrollOffset:g,containerSize:O,index:x,itemCount:o,itemSize:l});if(e){if(b=D({containerElement:e,direction:n,isRtl:r,scrollOffset:b}),typeof e.scrollTo!="function"){const k=V(b);N(u,k)||p(k)}return b}});return{getCellBounds:y,getEstimatedSize:E,scrollToIndex:M,startIndexOverscan:C,startIndexVisible:w,stopIndexOverscan:z,stopIndexVisible:R}}function te(e){return c.useMemo(()=>e,Object.values(e))}function ne(e,t){const{ariaAttributes:i,style:n,...r}=e,{ariaAttributes:o,style:s,...d}=t;return N(i,o)&&N(n,s)&&N(r,d)}function pe({cellComponent:e,cellProps:t,children:i,className:n,columnCount:r,columnWidth:o,defaultHeight:s=0,defaultWidth:d=0,dir:a,gridRef:f,onCellsRendered:u,onResize:p,overscanCount:w=3,rowCount:C,rowHeight:R,style:z,tagName:m="div",...I}){const T=te(t),O=c.useMemo(()=>c.memo(e,ne),[e]),[l,v]=c.useState(null),y=le(l,a),{getCellBounds:E,getEstimatedSize:V,startIndexOverscan:M,startIndexVisible:h,scrollToIndex:g,stopIndexOverscan:x,stopIndexVisible:b}=Q({containerElement:l,containerStyle:z,defaultContainerSize:d,direction:"horizontal",isRtl:y,itemCount:r,itemProps:T,itemSize:o,onResize:p,overscanCount:w}),{getCellBounds:k,getEstimatedSize:U,startIndexOverscan:j,startIndexVisible:X,scrollToIndex:q,stopIndexOverscan:$,stopIndexVisible:Z}=Q({containerElement:l,containerStyle:z,defaultContainerSize:s,direction:"vertical",itemCount:C,itemProps:T,itemSize:R,onResize:p,overscanCount:w});c.useImperativeHandle(f,()=>({get element(){return l},scrollToCell({behavior:L="auto",columnAlign:S="auto",columnIndex:W,rowAlign:B="auto",rowIndex:H}){const G=g({align:S,containerScrollOffset:(l==null?void 0:l.scrollLeft)??0,index:W}),se=q({align:B,containerScrollOffset:(l==null?void 0:l.scrollTop)??0,index:H});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:L,left:G,top:se})},scrollToColumn({align:L="auto",behavior:S="auto",index:W}){const B=g({align:L,containerScrollOffset:(l==null?void 0:l.scrollLeft)??0,index:W});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:S,left:B})},scrollToRow({align:L="auto",behavior:S="auto",index:W}){const B=q({align:L,containerScrollOffset:(l==null?void 0:l.scrollTop)??0,index:W});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:S,top:B})}}),[l,g,q]),c.useEffect(()=>{M>=0&&x>=0&&j>=0&&$>=0&&u&&u({columnStartIndex:h,columnStopIndex:b,rowStartIndex:X,rowStopIndex:Z},{columnStartIndex:M,columnStopIndex:x,rowStartIndex:j,rowStopIndex:$})},[u,M,h,x,b,j,X,$,Z]);const ie=c.useMemo(()=>{const L=[];if(r>0&&C>0)for(let S=j;S<=$;S++){const W=k(S),B=[];for(let H=M;H<=x;H++){const G=E(H);B.push(c.createElement(O,{...T,ariaAttributes:{"aria-colindex":H+1,role:"gridcell"},columnIndex:H,key:H,rowIndex:S,style:{position:"absolute",left:y?void 0:0,right:y?0:void 0,transform:`translate(${y?-G.scrollOffset:G.scrollOffset}px, ${W.scrollOffset}px)`,height:W.size,width:G.size}}))}L.push(J.jsx("div",{role:"row","aria-rowindex":S+1,children:B},S))}return L},[O,T,r,M,x,E,k,y,C,j,$]),oe=J.jsx("div",{"aria-hidden":!0,style:{height:U(),width:V(),zIndex:-1}});return c.createElement(m,{"aria-colcount":r,"aria-rowcount":C,role:"grid",...I,className:n,dir:a,ref:v,style:{position:"relative",width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto",...z}},ie,i,oe)}const ve=c.useState,ge=c.useRef;function be({children:e,className:t,defaultHeight:i=0,listRef:n,onResize:r,onRowsRendered:o,overscanCount:s=3,rowComponent:d,rowCount:a,rowHeight:f,rowProps:u,tagName:p="div",style:w,...C}){const R=te(u),z=c.useMemo(()=>c.memo(d,ne),[d]),[m,I]=c.useState(null),{getCellBounds:T,getEstimatedSize:O,scrollToIndex:l,startIndexOverscan:v,startIndexVisible:y,stopIndexOverscan:E,stopIndexVisible:V}=Q({containerElement:m,containerStyle:w,defaultContainerSize:i,direction:"vertical",itemCount:a,itemProps:R,itemSize:f,onResize:r,overscanCount:s});c.useImperativeHandle(n,()=>({get element(){return m},scrollToRow({align:g="auto",behavior:x="auto",index:b}){const k=l({align:g,containerScrollOffset:(m==null?void 0:m.scrollTop)??0,index:b});typeof(m==null?void 0:m.scrollTo)=="function"&&m.scrollTo({behavior:x,top:k})}}),[m,l]),c.useEffect(()=>{v>=0&&E>=0&&o&&o({startIndex:y,stopIndex:V},{startIndex:v,stopIndex:E})},[o,v,y,E,V]);const M=c.useMemo(()=>{const g=[];if(a>0)for(let x=v;x<=E;x++){const b=T(x);g.push(c.createElement(z,{...R,ariaAttributes:{"aria-posinset":x+1,"aria-setsize":a,role:"listitem"},key:x,index:x,style:{position:"absolute",left:0,transform:`translateY(${b.scrollOffset}px)`,height:b.size,width:"100%"}}))}return g},[z,T,a,R,v,E]),h=J.jsx("div",{"aria-hidden":!0,style:{height:O(),width:"100%",zIndex:-1}});return c.createElement(p,{role:"list",...C,className:t,ref:I,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...w}},M,e,h)}const ze=c.useState,Ie=c.useRef;let F=-1;function we(e=!1){if(F===-1||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",document.body.appendChild(t),F=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return F}export{pe as Grid,be as List,we as getScrollbarSize,ve as useGridCallbackRef,ge as useGridRef,ze as useListCallbackRef,Ie as useListRef};
