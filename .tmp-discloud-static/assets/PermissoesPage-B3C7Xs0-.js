import{u as D,d as we,r as o,j as e,l as F,z as L,I as ye,a as v,m as g,v as Ce,q as _e,G as O,B as I,F as w,t as B,M as G,i as q,D as J,X as W,E as Ee}from"./index-CCr23udO.js";import{S as X}from"./square-pen-CFWfA0Dv.js";import{T as H}from"./trash-2-IEheby2Z.js";import{F as Se}from"./filter-ClytLayh.js";const n=[{id:"users_view",module:"Usuários",action:"view",label:"Visualizar usuários",description:"Ver lista de usuários do sistema"},{id:"users_create",module:"Usuários",action:"create",label:"Criar usuários",description:"Cadastrar novos usuários"},{id:"users_edit",module:"Usuários",action:"edit",label:"Editar usuários",description:"Modificar dados de usuários"},{id:"users_delete",module:"Usuários",action:"delete",label:"Excluir usuários",description:"Remover usuários do sistema"},{id:"students_view",module:"Alunos",action:"view",label:"Visualizar alunos",description:"Ver lista de alunos"},{id:"students_create",module:"Alunos",action:"create",label:"Criar alunos",description:"Cadastrar novos alunos"},{id:"students_edit",module:"Alunos",action:"edit",label:"Editar alunos",description:"Modificar dados de alunos"},{id:"students_delete",module:"Alunos",action:"delete",label:"Excluir alunos",description:"Remover alunos do sistema"},{id:"classes_view",module:"Turmas",action:"view",label:"Visualizar turmas",description:"Ver lista de turmas"},{id:"classes_create",module:"Turmas",action:"create",label:"Criar turmas",description:"Cadastrar novas turmas"},{id:"classes_edit",module:"Turmas",action:"edit",label:"Editar turmas",description:"Modificar dados de turmas"},{id:"classes_delete",module:"Turmas",action:"delete",label:"Excluir turmas",description:"Remover turmas do sistema"},{id:"subjects_view",module:"Disciplinas",action:"view",label:"Visualizar disciplinas",description:"Ver lista de disciplinas"},{id:"subjects_create",module:"Disciplinas",action:"create",label:"Criar disciplinas",description:"Cadastrar novas disciplinas"},{id:"subjects_edit",module:"Disciplinas",action:"edit",label:"Editar disciplinas",description:"Modificar dados de disciplinas"},{id:"subjects_delete",module:"Disciplinas",action:"delete",label:"Excluir disciplinas",description:"Remover disciplinas do sistema"},{id:"grades_view",module:"Notas",action:"view",label:"Visualizar notas",description:"Ver notas dos alunos"},{id:"grades_create",module:"Notas",action:"create",label:"Lançar notas",description:"Cadastrar novas notas"},{id:"grades_edit",module:"Notas",action:"edit",label:"Editar notas",description:"Modificar notas existentes"},{id:"grades_delete",module:"Notas",action:"delete",label:"Excluir notas",description:"Remover notas do sistema"},{id:"attendance_view",module:"Presença",action:"view",label:"Visualizar presença",description:"Ver registros de presença"},{id:"attendance_create",module:"Presença",action:"create",label:"Registrar presença",description:"Fazer chamada dos alunos"},{id:"attendance_edit",module:"Presença",action:"edit",label:"Editar presença",description:"Modificar registros de presença"},{id:"attendance_delete",module:"Presença",action:"delete",label:"Excluir presença",description:"Remover registros de presença"},{id:"materials_view",module:"Materiais",action:"view",label:"Visualizar materiais",description:"Ver materiais didáticos"},{id:"materials_create",module:"Materiais",action:"create",label:"Criar materiais",description:"Adicionar novos materiais"},{id:"materials_edit",module:"Materiais",action:"edit",label:"Editar materiais",description:"Modificar materiais existentes"},{id:"materials_delete",module:"Materiais",action:"delete",label:"Excluir materiais",description:"Remover materiais do sistema"},{id:"messages_view",module:"Recados",action:"view",label:"Visualizar recados",description:"Ver recados e comunicados"},{id:"messages_create",module:"Recados",action:"create",label:"Criar recados",description:"Enviar novos recados"},{id:"messages_edit",module:"Recados",action:"edit",label:"Editar recados",description:"Modificar recados existentes"},{id:"messages_delete",module:"Recados",action:"delete",label:"Excluir recados",description:"Remover recados do sistema"},{id:"reports_view",module:"Relatórios",action:"view",label:"Visualizar relatórios",description:"Acessar relatórios do sistema"},{id:"reports_create",module:"Relatórios",action:"create",label:"Gerar relatórios",description:"Criar novos relatórios"},{id:"reports_edit",module:"Relatórios",action:"edit",label:"Editar relatórios",description:"Modificar relatórios existentes"},{id:"reports_delete",module:"Relatórios",action:"delete",label:"Excluir relatórios",description:"Remover relatórios salvos"},{id:"settings_view",module:"Configurações",action:"view",label:"Visualizar configurações",description:"Acessar configurações do sistema"},{id:"settings_create",module:"Configurações",action:"create",label:"Criar configurações",description:"Adicionar novas configurações"},{id:"settings_edit",module:"Configurações",action:"edit",label:"Editar configurações",description:"Modificar configurações do sistema"},{id:"settings_delete",module:"Configurações",action:"delete",label:"Excluir configurações",description:"Remover configurações"},{id:"audit_view",module:"Auditoria",action:"view",label:"Visualizar auditoria",description:"Acessar logs de auditoria"},{id:"audit_create",module:"Auditoria",action:"create",label:"Criar logs",description:"Gerar logs de auditoria"},{id:"audit_edit",module:"Auditoria",action:"edit",label:"Editar logs",description:"Modificar logs de auditoria"},{id:"audit_delete",module:"Auditoria",action:"delete",label:"Excluir logs",description:"Remover logs de auditoria"}],K=[{id:"admin",name:"Administrador",description:"Acesso total ao sistema. Pode gerenciar todos os módulos e usuários.",icon:"👑",color:"purple",permissions:n.map(y=>y.id),isCustom:!1,userCount:0},{id:"professor",name:"Professor",description:"Acesso às suas turmas e alunos. Pode lançar notas e controlar presença.",icon:"👨‍🏫",color:"green",permissions:["students_view","classes_view","subjects_view","grades_view","grades_create","grades_edit","attendance_view","attendance_create","attendance_edit","materials_view","materials_create","materials_edit","messages_view","messages_create","messages_edit"],isCustom:!1,userCount:0},{id:"pai",name:"Pai/Responsável",description:"Acesso limitado aos dados dos filhos. Pode visualizar notas, agenda e recados.",icon:"👨‍👩‍👧‍👦",color:"blue",permissions:["students_view","classes_view","subjects_view","grades_view","attendance_view","materials_view","messages_view"],isCustom:!1,userCount:0}],Pe=["👑","👨‍🏫","👨‍👩‍👧‍👦","📋","🏢","📞","📊","🔧","📚","🎯","⚙️","🛡️"],Q=[{value:"blue",label:"Azul",class:"bg-blue-100 text-blue-800 border-blue-200"},{value:"green",label:"Verde",class:"bg-green-100 text-green-800 border-green-200"},{value:"purple",label:"Roxo",class:"bg-purple-100 text-purple-800 border-purple-200"},{value:"yellow",label:"Amarelo",class:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"red",label:"Vermelho",class:"bg-red-100 text-red-800 border-red-200"},{value:"indigo",label:"Índigo",class:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"pink",label:"Rosa",class:"bg-pink-100 text-pink-800 border-pink-200"},{value:"gray",label:"Cinza",class:"bg-gray-100 text-gray-800 border-gray-200"}];function $e(){const{user:y}=D(),{isSupabaseConnected:Y}=D(),Z=we(y,Y),[f,ee]=o.useState("categorias"),[u,p]=o.useState(K),[se,ae]=o.useState([]),[re,ie]=o.useState([]),[te,oe]=o.useState(!0),[S,j]=o.useState(""),[C,b]=o.useState({}),le=(s,a)=>{if(!s)return"";try{const r=String(s).replace(/\D/g,""),t=r.startsWith("55")?r:`55${r}`,x=a?`?text=${encodeURIComponent(a)}`:"";return`https://wa.me/${t}${x}`}catch{return""}},[ne,h]=o.useState(!1),[de,P]=o.useState(!1),[d,A]=o.useState(null),[N,k]=o.useState(null),[i,c]=o.useState({name:"",description:"",icon:"📋",color:"blue",permissions:[],copyFromCategory:""}),[l,_]=o.useState({busca:"",categoria:"",status:""});o.useEffect(()=>{ce(),me(),ue()},[]),o.useEffect(()=>{const s=()=>{R()};return window.addEventListener("openNewCategoryModal",s),()=>{window.removeEventListener("openNewCategoryModal",s)}},[]);const ce=async()=>{try{const s=await Z.getUsuarios();ae(s),xe(s)}catch(s){console.error("Erro ao carregar dados:",s)}finally{oe(!1)}},me=()=>{const s=localStorage.getItem("userCategories");if(s)try{const a=JSON.parse(s);p([...K,...a.filter(r=>r.isCustom)])}catch(a){console.error("Erro ao carregar categorias:",a)}},ue=()=>{const s=localStorage.getItem("userPermissionOverrides");if(s)try{ie(JSON.parse(s))}catch(a){console.error("Erro ao carregar overrides:",a)}},M=()=>{const s=u.filter(a=>a.isCustom);localStorage.setItem("userCategories",JSON.stringify(s))},xe=s=>{p(a=>a.map(r=>({...r,userCount:s.filter(t=>t.tipo_usuario===r.id).length})))},R=()=>{c({name:"",description:"",icon:"📋",color:"blue",permissions:[],copyFromCategory:""}),A(null),h(!0)},ge=s=>{c({name:s.name,description:s.description,icon:s.icon,color:s.color,permissions:[...s.permissions],copyFromCategory:""}),A(s),h(!0)},pe=()=>{if(!i.name.trim()){b({categoryName:"Nome da categoria é obrigatório"});return}if(u.find(a=>a.name.toLowerCase()===i.name.toLowerCase()&&a.id!==(d==null?void 0:d.id))){b({categoryName:"Já existe uma categoria com este nome"});return}if(d)p(a=>a.map(r=>r.id===d.id?{...r,name:i.name,description:i.description,icon:i.icon,color:i.color,permissions:i.permissions}:r));else{const a={id:`custom_${Date.now()}`,name:i.name,description:i.description,icon:i.icon,color:i.color,permissions:i.permissions,isCustom:!0,userCount:0};p(r=>[...r,a])}M(),h(!1),b({}),j(d?"Categoria atualizada com sucesso!":"Categoria criada com sucesso!"),setTimeout(()=>j(""),3e3)},be=s=>{const a=u.find(r=>r.id===s);if(a){if(!a.isCustom){alert("Não é possível excluir categorias padrão do sistema.");return}if(a.userCount>0){alert(`Não é possível excluir a categoria "${a.name}" pois há ${a.userCount} usuário(s) vinculado(s).`);return}confirm(`Tem certeza que deseja excluir a categoria "${a.name}"?`)&&(p(r=>r.filter(t=>t.id!==s)),M(),j("Categoria excluída com sucesso!"),setTimeout(()=>j(""),3e3))}},he=s=>{const a=u.find(r=>r.id===s);a&&c(r=>({...r,permissions:[...a.permissions]}))},ve=s=>{c(a=>({...a,permissions:a.permissions.includes(s)?a.permissions.filter(r=>r!==s):[...a.permissions,s]}))},$=s=>{c(a=>({...a,permissions:s?n.map(r=>r.id):[]}))},U=(s,a)=>{const r=n.filter(t=>t.module===s).map(t=>t.id);c(t=>({...t,permissions:a?[...t.permissions.filter(x=>!r.includes(x)),...r]:t.permissions.filter(x=>!r.includes(x))}))},fe=s=>{const a=n.filter(t=>t.module===s);return{active:a.filter(t=>i.permissions.includes(t.id)).length,total:a.length}},E=s=>{const a=Q.find(r=>r.value===s);return(a==null?void 0:a.class)||"bg-gray-100 text-gray-800 border-gray-200"},z=s=>{switch(s){case"view":return e.jsx(Ee,{className:"h-3 w-3"});case"create":return e.jsx(L,{className:"h-3 w-3"});case"edit":return e.jsx(X,{className:"h-3 w-3"});case"delete":return e.jsx(H,{className:"h-3 w-3"});default:return e.jsx(g,{className:"h-3 w-3"})}},V=s=>{switch(s){case"view":return"text-blue-600";case"create":return"text-green-600";case"edit":return"text-yellow-600";case"delete":return"text-red-600";default:return"text-gray-600"}},je=se.filter(s=>{const a=!l.busca||s.nome.toLowerCase().includes(l.busca.toLowerCase())||s.email.toLowerCase().includes(l.busca.toLowerCase()),r=!l.categoria||s.tipo_usuario===l.categoria,t=!l.status||l.status==="ativo"&&s.ativo||l.status==="inativo"&&!s.ativo;return a&&r&&t}),T=[...new Set(n.map(s=>s.module))];return te?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg",children:e.jsx(F,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:"🔐 Gestão de Permissões"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Controle total de acesso ao sistema"})]})]}),e.jsxs("button",{onClick:R,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Nova Categoria"})]})]}),S&&e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2 text-green-700",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:S})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"categorias",label:"Categorias de Usuário",icon:F},{id:"usuarios",label:"Usuários",icon:v},{id:"permissoes",label:"Todas as Permissões",icon:g}].map(s=>{const a=s.icon;return e.jsx("button",{onClick:()=>ee(s.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${f===s.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{children:s.label})]})},s.id)})})}),e.jsxs("div",{className:"p-6",children:[f==="categorias"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>e.jsxs("div",{className:`border-2 rounded-xl p-6 transition-all hover:shadow-lg ${E(s.color)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:s.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.name}),e.jsxs("p",{className:"text-sm opacity-75",children:[s.userCount," usuários"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>ge(s),className:"p-1 hover:bg-white hover:bg-opacity-50 rounded transition-colors",children:e.jsx(X,{className:"h-4 w-4"})}),s.isCustom&&e.jsx("button",{onClick:()=>be(s.id),className:"p-1 hover:bg-white hover:bg-opacity-50 rounded transition-colors",children:e.jsx(H,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-sm opacity-90 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Permissões:"}),e.jsxs("span",{className:"text-sm font-bold",children:[s.permissions.length,"/",n.length]})]}),e.jsx("div",{className:"w-full bg-white bg-opacity-50 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all",style:{width:`${s.permissions.length/n.length*100}%`,backgroundColor:s.color==="yellow"?"#f59e0b":s.color==="blue"?"#3b82f6":s.color==="green"?"#10b981":s.color==="purple"?"#8b5cf6":s.color==="red"?"#ef4444":"#6b7280"}})})]}),!s.isCustom&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white border-opacity-30",children:e.jsx("span",{className:"text-xs font-medium opacity-75",children:"🔒 Categoria padrão do sistema"})})]},s.id))})}),f==="usuarios"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Se,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:l.busca,onChange:s=>_({...l,busca:s.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("select",{value:l.categoria,onChange:s=>_({...l,categoria:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{value:l.status,onChange:s=>_({...l,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"ativo",children:"Ativo"}),e.jsx("option",{value:"inativo",children:"Inativo"})]})]})]}),e.jsx("div",{className:"space-y-4",children:je.map(s=>{const a=u.find(t=>t.id===s.tipo_usuario),r=re.some(t=>t.userId===s.id);return e.jsx("div",{className:`border-2 rounded-xl p-4 transition-all hover:shadow-md ${r?"border-yellow-300 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:s.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.nome}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a&&e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full border ${E(a.color)}`,children:[a.icon," ",a.name]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.ativo?"Ativo":"Inativo"}),r&&e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"⚙️ Personalizado"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.telefone&&e.jsxs("a",{href:le(s.telefone,`Olá ${s.nome}`),target:"_blank",rel:"noopener noreferrer",title:"Abrir WhatsApp",className:"flex items-center space-x-2 px-3 py-2 border border-green-200 text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"WhatsApp"})]}),a&&e.jsxs("div",{className:"text-right mr-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[a.permissions.length," permissões"]}),e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r?"bg-yellow-500":"bg-green-500"}`,style:{width:`${a.permissions.length/n.length*100}%`}})})]}),e.jsxs("button",{onClick:()=>{k(s),P(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{children:"Configurar"})]})]})]})},s.id)})})]}),f==="permissoes"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["📋 Todas as Permissões do Sistema (",n.length,")"]}),T.map(s=>{const a=n.filter(r=>r.module===s);return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsxs("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:[s==="Usuários"&&e.jsx(v,{className:"h-5 w-5 text-blue-600"}),s==="Alunos"&&e.jsx(O,{className:"h-5 w-5 text-blue-600"}),s==="Turmas"&&e.jsx(v,{className:"h-5 w-5 text-blue-600"}),s==="Disciplinas"&&e.jsx(I,{className:"h-5 w-5 text-blue-600"}),s==="Notas"&&e.jsx(w,{className:"h-5 w-5 text-blue-600"}),s==="Presença"&&e.jsx(B,{className:"h-5 w-5 text-blue-600"}),s==="Materiais"&&e.jsx(w,{className:"h-5 w-5 text-blue-600"}),s==="Recados"&&e.jsx(G,{className:"h-5 w-5 text-blue-600"}),s==="Relatórios"&&e.jsx(q,{className:"h-5 w-5 text-blue-600"}),s==="Configurações"&&e.jsx(g,{className:"h-5 w-5 text-blue-600"}),s==="Auditoria"&&e.jsx(J,{className:"h-5 w-5 text-blue-600"})]}),s]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(r=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:`p-1 rounded ${V(r.action)}`,children:z(r.action)}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:r.label}),e.jsx("p",{className:"text-xs text-gray-500",children:r.description})]})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",r.id]})]},r.id))})]},s)})]})]})]}),ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d?"Editar Categoria":"Nova Categoria de Usuário"}),e.jsx("button",{onClick:()=>{h(!1),b({})},className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(W,{className:"h-5 w-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Categoria *"}),e.jsx("input",{type:"text",value:i.name,onChange:s=>c({...i,name:s.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent ${C.categoryName?"border-red-300":"border-gray-300"}`,placeholder:"Ex: Secretaria, Coordenação"}),C.categoryName&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:C.categoryName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Copiar Permissões de:"}),e.jsxs("select",{value:i.copyFromCategory,onChange:s=>{c({...i,copyFromCategory:s.target.value}),s.target.value&&he(s.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione uma categoria base"}),u.filter(s=>s.id!==(d==null?void 0:d.id)).map(s=>e.jsxs("option",{value:s.id,children:[s.icon," ",s.name]},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:i.description,onChange:s=>c({...i,description:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Descreva as responsabilidades e acesso desta categoria..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ícone"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:Pe.map(s=>e.jsx("button",{onClick:()=>c({...i,icon:s}),className:`p-3 border rounded-lg text-center transition-colors ${i.icon===s?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,children:e.jsx("span",{className:"text-xl",children:s})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Q.map(s=>e.jsx("button",{onClick:()=>c({...i,color:s.value}),className:`p-3 border rounded-lg text-center transition-colors ${i.color===s.value?`border-${s.value}-500 ${s.class}`:"border-gray-300 hover:border-gray-400"}`,children:e.jsx("span",{className:"text-sm font-medium",children:s.label})},s.value))})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preview:"}),e.jsxs("div",{className:`inline-flex items-center space-x-2 px-3 py-2 rounded-lg border ${E(i.color)}`,children:[e.jsx("span",{className:"text-lg",children:i.icon}),e.jsx("span",{className:"font-medium",children:i.name||"Nome da Categoria"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Configurar Permissões (",i.permissions.length,"/",n.length,")"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>$(!0),className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:"Todas"}),e.jsx("button",{onClick:()=>$(!1),className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm",children:"Nenhuma"})]})]}),e.jsx("div",{className:"space-y-4",children:T.map(s=>{const a=n.filter(m=>m.module===s),{active:r,total:t}=fe(s),x=r===t,Ne=r===0;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"p-2 bg-blue-100 rounded-lg",children:[s==="Usuários"&&e.jsx(v,{className:"h-4 w-4 text-blue-600"}),s==="Alunos"&&e.jsx(O,{className:"h-4 w-4 text-blue-600"}),s==="Turmas"&&e.jsx(v,{className:"h-4 w-4 text-blue-600"}),s==="Disciplinas"&&e.jsx(I,{className:"h-4 w-4 text-blue-600"}),s==="Notas"&&e.jsx(w,{className:"h-4 w-4 text-blue-600"}),s==="Presença"&&e.jsx(B,{className:"h-4 w-4 text-blue-600"}),s==="Materiais"&&e.jsx(w,{className:"h-4 w-4 text-blue-600"}),s==="Recados"&&e.jsx(G,{className:"h-4 w-4 text-blue-600"}),s==="Relatórios"&&e.jsx(q,{className:"h-4 w-4 text-blue-600"}),s==="Configurações"&&e.jsx(g,{className:"h-4 w-4 text-blue-600"}),s==="Auditoria"&&e.jsx(J,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:s}),e.jsxs("p",{className:"text-sm text-gray-500",children:[r,"/",t," permissões"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>U(s,!0),disabled:x,className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200 transition-colors disabled:opacity-50",children:"Todas"}),e.jsx("button",{onClick:()=>U(s,!1),disabled:Ne,className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs hover:bg-red-200 transition-colors disabled:opacity-50",children:"Nenhuma"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${r/t*100}%`}})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map(m=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.permissions.includes(m.id),onChange:()=>ve(m.id),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("div",{className:`p-1 rounded ${V(m.action)}`,children:z(m.action)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:m.label}),e.jsx("div",{className:"text-xs text-gray-500",children:m.description})]})]},m.id))})]},s)})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{h(!1),b({})},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:pe,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:d?"Salvar Alterações":"Criar Categoria"})]})]})}),de&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:N.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Configurar Permissões - ",N.nome]}),e.jsx("p",{className:"text-sm text-gray-500",children:N.email})]})]}),e.jsx("button",{onClick:()=>{P(!1),k(null)},className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(W,{className:"h-5 w-5 text-gray-500"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(g,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium",children:"Configuração Individual de Usuário"}),e.jsx("p",{className:"text-sm mt-2",children:"Esta funcionalidade será implementada em breve"})]})})]})})]})}export{$e as PermissoesPage};
