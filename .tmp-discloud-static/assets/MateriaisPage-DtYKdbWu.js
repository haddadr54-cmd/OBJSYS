import{u as X,d as re,r,j as e,F as S,X as ae,I as ne,B as te,K as I,a as ie,x as de,y as ue,N as me,z as xe,v as pe,s as he,f as ge,O as fe}from"./index-CCr23udO.js";import{V as Q,L as G,I as be}from"./ItemDetailModal-Dr1W76Xe.js";import{U as je}from"./upload-DIwgGHqY.js";import{S as ve}from"./save-BDGo1Gz5.js";import{F as Ne}from"./filter-ClytLayh.js";import{S as ye}from"./square-pen-CFWfA0Dv.js";import{T as we}from"./trash-2-IEheby2Z.js";import"./gradeConfig-C64ZX5y1.js";function _e({isOpen:o,onClose:v,material:d,onSave:N}){const{user:y}=X(),{isSupabaseConnected:R}=X(),D=re(y,R),[V,P]=r.useState([]),[l,C]=r.useState([]),[a,x]=r.useState({disciplina_id:"",titulo:"",tipo:"pdf",arquivo_url:"",descricao:""}),[u,b]=r.useState({}),[i,m]=r.useState(!1),[p,c]=r.useState(!1),[h,k]=r.useState(0);r.useEffect(()=>{o&&y&&W()},[o,y]),r.useEffect(()=>{x(d?{disciplina_id:d.disciplina_id,titulo:d.titulo,tipo:d.tipo,arquivo_url:d.arquivo_url||"",descricao:d.descricao||""}:{disciplina_id:"",titulo:"",tipo:"pdf",arquivo_url:"",descricao:""}),b({}),c(!1),k(0)},[d,o]);const W=async()=>{try{const[t,g]=await Promise.all([D.getTurmas(),D.getDisciplinas()]);P(t),C(g),g.length===1&&x(w=>({...w,disciplina_id:g[0].id}))}catch(t){console.error("Erro ao carregar dados:",t)}},O=()=>{const t={};if(a.disciplina_id||(t.disciplina_id="Disciplina √© obrigat√≥ria"),(!a.titulo.trim()||a.titulo.length<3)&&(t.titulo="T√≠tulo deve ter pelo menos 3 caracteres"),a.tipo||(t.tipo="Tipo de material √© obrigat√≥rio"),a.tipo==="link"&&!a.arquivo_url.trim())t.arquivo_url="URL √© obrigat√≥ria para links";else if(a.tipo==="link"&&a.arquivo_url.trim())try{new URL(a.arquivo_url)}catch{t.arquivo_url="URL inv√°lida"}if(a.tipo==="video"&&a.arquivo_url.trim()){const g=a.arquivo_url.includes("youtube.com")||a.arquivo_url.includes("youtu.be"),w=a.arquivo_url.includes("vimeo.com");!g&&!w&&(t.arquivo_url="URL deve ser do YouTube ou Vimeo")}return b(t),Object.keys(t).length===0},q=t=>{var w;const g=(w=t.target.files)==null?void 0:w[0];if(g){if(g.size>10*1024*1024){b({...u,arquivo_url:"Arquivo deve ter no m√°ximo 10MB"});return}const _={pdf:["application/pdf"],imagem:["image/jpeg","image/png","image/gif","image/webp"]};if(a.tipo==="pdf"&&!_.pdf.includes(g.type)){b({...u,arquivo_url:"Apenas arquivos PDF s√£o permitidos"});return}if(a.tipo==="imagem"&&_.imagem&&!_.imagem.includes(g.type)){b({...u,arquivo_url:"Apenas imagens JPG, PNG, GIF ou WebP s√£o permitidas"});return}k(0);const z=new FileReader;z.onprogress=F=>{if(F.lengthComputable){const A=F.loaded/F.total*100;k(A)}},z.onload=F=>{var K;const A=(K=F.target)==null?void 0:K.result;x({...a,arquivo_url:A}),b({...u,arquivo_url:""}),k(100)},z.readAsDataURL(g)}},Y=async t=>{if(t.preventDefault(),!!O()){m(!0);try{d?(await D.updateMaterial(d.id,a),console.log("‚úÖ Material atualizado")):(await D.createMaterial(a),console.log("‚úÖ Material criado")),c(!0),setTimeout(()=>{N(),v(),j()},1500)}catch(g){console.error("Erro ao salvar material:",g),b({submit:"Erro ao salvar material"})}finally{m(!1)}}},j=()=>{x({disciplina_id:"",titulo:"",tipo:"pdf",arquivo_url:"",descricao:""}),b({}),c(!1),k(0)},J=t=>{switch(t){case"pdf":return e.jsx(S,{className:"h-5 w-5"});case"video":return e.jsx(Q,{className:"h-5 w-5"});case"link":return e.jsx(G,{className:"h-5 w-5"});default:return e.jsx(S,{className:"h-5 w-5"})}};if(!o)return null;const M=l.find(t=>t.id===a.disciplina_id),T=V.find(t=>t.id===(M==null?void 0:M.turma_id));return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-full",children:e.jsx(S,{className:"h-5 w-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d?"Editar Material":"Novo Material Did√°tico"})]}),e.jsx("button",{onClick:()=>{v(),j()},className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ae,{className:"h-5 w-5 text-gray-500"})})]}),p&&e.jsx("div",{className:"p-4 bg-green-50 border-b border-green-200",children:e.jsxs("div",{className:"flex items-center space-x-2 text-green-700",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:d?"Material atualizado com sucesso!":"Material criado com sucesso!"})]})}),e.jsxs("form",{onSubmit:Y,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tipo de Material *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{value:"pdf",label:"PDF",icon:S,color:"red"},{value:"video",label:"V√≠deo",icon:Q,color:"purple"},{value:"link",label:"Link",icon:G,color:"blue"}].map(({value:t,label:g,icon:w,color:_})=>e.jsxs("button",{type:"button",onClick:()=>x({...a,tipo:t,arquivo_url:""}),className:`p-4 border rounded-lg text-center transition-colors ${a.tipo===t?`border-${_}-500 bg-${_}-50 text-${_}-700`:"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("div",{className:`p-2 bg-${_}-100 rounded-full w-fit mx-auto mb-2`,children:e.jsx(w,{className:`h-5 w-5 text-${_}-600`})}),e.jsx("span",{className:"text-sm font-medium",children:g})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disciplina *"}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsxs("select",{value:a.disciplina_id,onChange:t=>x({...a,disciplina_id:t.target.value}),className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${u.disciplina_id?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione uma disciplina"}),l.map(t=>e.jsx("option",{value:t.id,children:t.nome},t.id))]})]}),u.disciplina_id&&e.jsxs("p",{className:"text-red-600 text-xs mt-1 flex items-center",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),u.disciplina_id]})]}),a.disciplina_id&&M&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:M.cor||"#3B82F6"}}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:M.nome})]}),T&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:T.nome})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T√≠tulo do Material *"}),e.jsx("input",{type:"text",value:a.titulo,onChange:t=>x({...a,titulo:t.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${u.titulo?"border-red-300":"border-gray-300"}`,placeholder:`Ex: ${a.tipo==="pdf"?"Apostila de Matem√°tica - Fra√ß√µes":a.tipo==="video"?"V√≠deo Aula - Sistema Solar":a.tipo==="link"?"Site Educativo - Portugu√™s":"Diagrama - Ciclo da √Ågua"}`}),u.titulo&&e.jsxs("p",{className:"text-red-600 text-xs mt-1 flex items-center",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),u.titulo]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a.tipo==="link"?"URL do Link *":a.tipo==="video"?"URL do V√≠deo":"Arquivo"}),a.tipo==="link"||a.tipo==="video"?e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"url",value:a.arquivo_url,onChange:t=>x({...a,arquivo_url:t.target.value}),className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${u.arquivo_url?"border-red-300":"border-gray-300"}`,placeholder:a.tipo==="link"?"https://exemplo.com":"https://youtube.com/watch?v=... ou https://vimeo.com/..."})]}):e.jsxs("div",{className:"space-y-3",children:[a.arquivo_url&&e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[J(a.tipo),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Arquivo selecionado"}),e.jsx("p",{className:"text-xs text-gray-500",children:a.tipo==="pdf"?"Documento PDF":"Imagem"})]}),e.jsx("button",{type:"button",onClick:()=>x({...a,arquivo_url:""}),className:"text-red-600 hover:text-red-800",children:e.jsx(ae,{className:"h-4 w-4"})})]}),h>0&&h<100&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${h}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(h),"% carregado"]})]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:".pdf",onChange:q,className:"hidden",id:"arquivo-upload"}),e.jsxs("label",{htmlFor:"arquivo-upload",className:"flex items-center justify-center px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[e.jsx(je,{className:"h-5 w-5 mr-2 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar PDF"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Arquivos PDF at√© 10MB"})]})]}),u.arquivo_url&&e.jsxs("p",{className:"text-red-600 text-xs mt-1 flex items-center",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),u.arquivo_url]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri√ß√£o/Instru√ß√µes"}),e.jsx("textarea",{value:a.descricao,onChange:t=>x({...a,descricao:t.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descreva o material, como usar, objetivos de aprendizagem..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.descricao.length,"/500 caracteres"]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:a.tipo==="pdf"?"üìÑ Dicas para PDFs:":a.tipo==="video"?"üé• Dicas para V√≠deos:":"üîó Dicas para Links:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[a.tipo==="pdf"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"‚Ä¢ Use PDFs com texto pesquis√°vel"}),e.jsx("li",{children:"‚Ä¢ Organize o conte√∫do em cap√≠tulos"}),e.jsx("li",{children:"‚Ä¢ Inclua exerc√≠cios e exemplos"}),e.jsx("li",{children:"‚Ä¢ Mantenha boa qualidade de imagem"})]}),a.tipo==="video"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"‚Ä¢ Use YouTube ou Vimeo para melhor compatibilidade"}),e.jsx("li",{children:"‚Ä¢ V√≠deos de 5-15 minutos s√£o ideais"}),e.jsx("li",{children:"‚Ä¢ Inclua legendas quando poss√≠vel"}),e.jsx("li",{children:"‚Ä¢ Teste o √°udio e qualidade da imagem"})]}),a.tipo==="link"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"‚Ä¢ Verifique se o site √© educativo e seguro"}),e.jsx("li",{children:"‚Ä¢ Teste o link antes de compartilhar"}),e.jsx("li",{children:"‚Ä¢ Prefira sites com conte√∫do interativo"}),e.jsx("li",{children:"‚Ä¢ Evite sites com muita publicidade"})]})]})]}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma disciplina atribu√≠da"}),e.jsx("p",{className:"text-gray-500",children:"Voc√™ ainda n√£o possui disciplinas atribu√≠das. Entre em contato com o administrador."})]}),u.submit&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-700 text-sm flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),u.submit]})})]}),l.length>0&&e.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{v(),j()},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsxs("button",{onClick:Y,disabled:i||p,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:i?"Salvando...":d?"Salvar Altera√ß√µes":"Criar Material"})]})]})]})})}function ke(o={}){const{enabled:v=!0,initialFetch:d=!0}=o,[N,y]=r.useState([]),[R,D]=r.useState(!!d),[V,P]=r.useState(null),l=r.useRef(new Map),C=r.useRef(!1),a=r.useRef([]),x=r.useCallback(i=>{l.current.clear(),i.forEach(m=>l.current.set(m.id,m)),y(Array.from(l.current.values()).sort((m,p)=>p.criado_em.localeCompare(m.criado_em)))},[]),u=r.useCallback(()=>{var m,p;if(a.current.length===0)return;const i=l.current;for(const c of a.current)if(c.action==="INSERT"&&c.newRecord)i.set(c.newRecord.id,c.newRecord);else if(c.action==="UPDATE"&&c.newRecord)i.set(c.newRecord.id,c.newRecord);else if(c.action==="DELETE"){const h=((m=c.oldRecord)==null?void 0:m.id)||((p=c.newRecord)==null?void 0:p.id);h&&i.delete(h)}a.current=[],y(Array.from(i.values()).sort((c,h)=>h.criado_em.localeCompare(c.criado_em)))},[]),b=r.useCallback(async()=>{if(v)try{D(!0);const{data:i,error:m}=await de.from("materiais").select("*, disciplina:disciplinas(*)").order("criado_em",{ascending:!1});if(m)throw m;x(i||[]),C.current=!0,u()}catch(i){P(i.message||"Erro ao carregar materiais")}finally{D(!1)}},[x,v,u]);return ue("materiais",i=>{var p,c;if(!v)return;if(!C.current){a.current.push(i);return}const m=l.current;if(i.action==="INSERT"&&i.newRecord)m.set(i.newRecord.id,i.newRecord);else if(i.action==="UPDATE"&&i.newRecord)m.set(i.newRecord.id,i.newRecord);else if(i.action==="DELETE"){const h=((p=i.oldRecord)==null?void 0:p.id)||((c=i.newRecord)==null?void 0:c.id);h&&m.delete(h)}y(Array.from(m.values()).sort((h,k)=>k.criado_em.localeCompare(h.criado_em)))}),r.useEffect(()=>{v&&d&&b()},[v,d,b]),{materiais:N,loading:R,error:V,refetch:b}}function Te(){var H,Z;const{user:o,isSupabaseConnected:v}=X(),d=re(o,v),[N,y]=r.useState([]),[R,D]=r.useState([]),[V,P]=r.useState([]),[l,C]=r.useState({busca:"",turma:"",disciplina:"",tipo:""}),[a,x]=r.useState(!1),[u,b]=r.useState(null),[i,m]=r.useState(!0),[p,c]=r.useState({}),[h,k]=r.useState({}),[W,O]=r.useState(!1),[q,Y]=r.useState(null),j=v,{materiais:J,loading:M}=ke({enabled:!!o&&j,initialFetch:!0});r.useEffect(()=>{o&&!j&&T()},[o,j]),r.useEffect(()=>{j&&y(J)},[J,j]);const T=async()=>{try{const[s,n,f]=await Promise.all([d.getMateriais(),d.getTurmas(),d.getDisciplinas()]);y(s),D(n),P(f)}catch(s){console.error("Erro ao carregar materiais:",s)}finally{m(!1),N.length>0&&t()}},t=async()=>{if(o.tipo_usuario==="professor"||o.tipo_usuario==="admin")try{const s={};for(const n of N){const f=await me("material",n.id);s[n.id]={stats:f}}c(s)}catch(s){console.error("Erro ao buscar visualiza√ß√µes:",s)}},g=async s=>{if(h[s])k(n=>({...n,[s]:!1}));else try{const n=await fe("material",s);c(f=>({...f,[s]:{...f[s],detalhes:n}})),k(f=>({...f,[s]:!0}))}catch(n){console.error("Erro ao buscar detalhes de visualiza√ß√£o:",n)}},w=N.filter(s=>{var U;const n=!l.busca||s.titulo.toLowerCase().includes(l.busca.toLowerCase()),f=!l.turma||((U=s.disciplina)==null?void 0:U.turma_id)===l.turma,E=!l.disciplina||s.disciplina_id===l.disciplina,L=!l.tipo||s.tipo===l.tipo;return n&&f&&E&&L}),_=s=>{b(s),x(!0)},z=async s=>{if(!confirm(`Tem certeza que deseja excluir "${s.titulo}"?`))return;const n=j;let f=null;n&&(f=[...N],y(E=>E.filter(L=>L.id!==s.id)));try{await d.deleteMaterial(s.id),n||T()}catch(E){console.error("Erro ao excluir material:",E),f&&y(f),alert("Erro ao excluir material")}},F=s=>{o.tipo_usuario==="pai"&&ge("material",s.id).catch(n=>{console.error("Erro ao registrar visualiza√ß√£o:",n)}),Y(s),O(!0)},A=()=>{x(!1),b(null)},K=()=>{j||T()},le=s=>{switch(s){case"pdf":return e.jsx(S,{className:"h-5 w-5"});case"video":return e.jsx(Q,{className:"h-5 w-5"});case"link":return e.jsx(G,{className:"h-5 w-5"});default:return e.jsx(S,{className:"h-5 w-5"})}},oe=s=>{switch(s){case"pdf":return"PDF";case"video":return"V√≠deo";case"link":return"Link";default:return"Material"}},ce=s=>{switch(s){case"pdf":return"bg-red-100 text-red-700";case"video":return"bg-purple-100 text-purple-700";case"link":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}};return i&&!j||j&&M?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(S,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:o.tipo_usuario==="pai"?"üìö Materiais dos Filhos":o.tipo_usuario==="professor"?"üéØ Meus Materiais Did√°ticos":"üìñ Gest√£o de Materiais"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:o.tipo_usuario==="pai"?"Recursos educacionais dispon√≠veis":"Compartilhe conhecimento com seus alunos"})]})]}),(o.tipo_usuario==="professor"||o.tipo_usuario==="admin")&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Novo Material"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ne,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por t√≠tulo...",value:l.busca,onChange:s=>C({...l,busca:s.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:l.turma,onChange:s=>C({...l,turma:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as turmas"}),R.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]}),e.jsxs("select",{value:l.disciplina,onChange:s=>C({...l,disciplina:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as disciplinas"}),V.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]}),e.jsxs("select",{value:l.tipo,onChange:s=>C({...l,tipo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os tipos"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"video",children:"V√≠deo"}),e.jsx("option",{value:"link",children:"Link"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl border-2 border-blue-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-blue-600 uppercase tracking-wide",children:"üìö Total"}),e.jsx("p",{className:"text-3xl font-black text-blue-700",children:N.length})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:e.jsx(S,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-red-50 rounded-2xl shadow-xl border-2 border-red-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-red-600 uppercase tracking-wide",children:"üìÑ PDFs"}),e.jsx("p",{className:"text-3xl font-black text-red-700",children:N.filter(s=>s.tipo==="pdf").length})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-red-400 to-red-600 rounded-2xl shadow-lg",children:e.jsx(S,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-purple-50 rounded-2xl shadow-xl border-2 border-purple-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-purple-600 uppercase tracking-wide",children:"üé• V√≠deos"}),e.jsx("p",{className:"text-3xl font-black text-purple-700",children:N.filter(s=>s.tipo==="video").length})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl shadow-lg",children:e.jsx(Q,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl border-2 border-blue-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-blue-600 uppercase tracking-wide",children:"üîó Links"}),e.jsx("p",{className:"text-3xl font-black text-blue-700",children:N.filter(s=>s.tipo==="link").length})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:e.jsx(G,{className:"h-8 w-8 text-white"})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.length===0?e.jsxs("div",{className:"col-span-full bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(S,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum material encontrado"}),e.jsx("p",{className:"text-gray-500",children:o.tipo_usuario==="professor"?'Crie seu primeiro material did√°tico clicando em "Novo Material".':"Ajuste os filtros ou aguarde novos materiais serem adicionados."})]}):w.map(s=>{var n,f,E,L,U,ee,se;return e.jsx("div",{className:"bg-gradient-to-br from-white via-gray-50 to-blue-50 rounded-2xl shadow-xl border-2 border-gray-200 hover:shadow-2xl hover:border-blue-400 hover:scale-110 hover:rotate-1 transition-all duration-300 cursor-pointer group",onClick:()=>F(s),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl shadow-lg",children:le(s.tipo)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-gray-900 group-hover:text-blue-700 transition-colors line-clamp-2 text-lg",children:s.titulo}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`px-3 py-1 text-xs rounded-xl font-bold shadow-sm ${ce(s.tipo)}`,children:oe(s.tipo)}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:((n=s.disciplina)==null?void 0:n.cor)||"#3B82F6"}}),e.jsx("span",{className:"text-xs text-gray-600 font-semibold",children:(f=s.disciplina)==null?void 0:f.nome})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[(o.tipo_usuario==="professor"||o.tipo_usuario==="admin")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(s.id),className:"text-gray-600 hover:text-green-600 p-1 rounded hover:bg-green-50",title:"Ver quem visualizou",children:((L=(E=p[s.id])==null?void 0:E.stats)==null?void 0:L.usuariosUnicos)>0?e.jsx(he,{className:"h-4 w-4 text-green-600"}):e.jsx(I,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",children:e.jsx(ye,{className:"h-4 w-4"})})]}),(o.tipo_usuario==="professor"||o.tipo_usuario==="admin")&&e.jsx("button",{onClick:()=>z(s),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",children:e.jsx(we,{className:"h-4 w-4"})})]})]}),s.descricao&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3",children:s.descricao}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 font-bold",children:"üè´ Turma:"}),e.jsx("span",{className:"font-black text-gray-900",children:((U=R.find($=>{var B;return $.id===((B=s.disciplina)==null?void 0:B.turma_id)}))==null?void 0:U.nome)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 font-bold",children:"üìö Disciplina:"}),e.jsx("span",{className:"font-black text-gray-900",children:(ee=s.disciplina)==null?void 0:ee.nome})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 font-bold",children:"üìÖ Criado em:"}),e.jsxs("span",{className:"text-gray-700 font-semibold",children:["üìÖ ",new Date(s.criado_em).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",weekday:"short"})]})]}),(o.tipo_usuario==="professor"||o.tipo_usuario==="admin")&&p[s.id]&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 font-bold",children:"üëÅÔ∏è Visualiza√ß√µes:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-black text-green-700",children:p[s.id].stats.usuariosUnicos})]})]})]}),h[s.id]&&((se=p[s.id])==null?void 0:se.detalhes)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Quem visualizou:"}),e.jsxs("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:[p[s.id].detalhes.slice(0,3).map($=>{var B;return e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:(B=$.usuario)==null?void 0:B.nome}),e.jsx("span",{className:"text-gray-500",children:new Date($.visualizado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})})]},$.id)}),p[s.id].detalhes.length>3&&e.jsxs("div",{className:"text-xs text-gray-400 text-center pt-1",children:["+",p[s.id].detalhes.length-3," mais..."]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-blue-700 text-center font-black opacity-0 group-hover:opacity-100 transition-opacity bg-blue-100 px-3 py-2 rounded-xl",children:["‚ú® Clique para ",s.tipo==="link"?"abrir link":s.tipo==="video"?"assistir v√≠deo":"visualizar/baixar"]})})]})},s.id)})}),e.jsx(_e,{isOpen:a,onClose:A,material:u,onSave:K}),e.jsx(be,{isOpen:W,onClose:()=>O(!1),item:q,type:"material",turmaName:q?(H=R.find(s=>{var n;return s.id===((n=q.disciplina)==null?void 0:n.turma_id)}))==null?void 0:H.nome:"",disciplinaName:(Z=q==null?void 0:q.disciplina)==null?void 0:Z.nome})]})}export{Te as MateriaisPage};
