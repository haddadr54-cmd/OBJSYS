const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BJRSlDEO.js","assets/index-BjT7p4Wm.css"])))=>i.map(i=>d[i]);
import{g as O,u as te,d as re,r as l,_ as N,j as e,af as y,a5 as ne,a as w,B as F,C as z,h as k,X as S}from"./index-BJRSlDEO.js";import{d as le,F as ie}from"./NotificacoesPage-CIhIZHN6.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=O("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=O("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function me(){var B,U,q;const{user:u,isSupabaseConnected:P}=te(),D=re(u,P),[b,V]=l.useState([]),[f,X]=l.useState([]),[r,_]=l.useState(""),[d,H]=l.useState(new Date().toISOString().split("T")[0]),[g,o]=l.useState([]),[Q,Z]=l.useState(!0),[E,C]=l.useState(!1),[c,j]=l.useState(""),[T,G]=l.useState([]),[J,K]=l.useState([]),[p,W]=l.useState(!1),[A,$]=l.useState(null);l.useEffect(()=>{u&&ee()},[u,P]),l.useEffect(()=>{r&&Y()},[r,f]),l.useEffect(()=>{r&&c&&d&&I()},[r,c,d]);const Y=async()=>{try{const{getAllDisciplinas:s}=await N(async()=>{const{getAllDisciplinas:t}=await import("./index-BJRSlDEO.js").then(i=>i.aq);return{getAllDisciplinas:t}},__vite__mapDeps([0,1])),a=(await s()).filter(t=>t.turma_id===r&&t.professor_id===u.id);G(a),a.length===1&&j(a[0].id)}catch(s){console.error("Erro ao carregar disciplinas:",s)}},ee=async()=>{try{const[s,n]=await Promise.all([D.getTurmas(),D.getAlunos()]);V(s),X(n),s.length>0&&!r&&_(s[0].id)}catch(s){console.error("Erro ao carregar dados:",s)}finally{Z(!1)}},I=async()=>{try{const{getPresencasByTurmaData:s}=await N(async()=>{const{getPresencasByTurmaData:a}=await import("./index-BJRSlDEO.js").then(t=>t.aq);return{getPresencasByTurmaData:a}},__vite__mapDeps([0,1])),n=await s(r,d,c);K(n),L(n)}catch(s){console.error("Erro ao carregar presen√ßas existentes:",s),L([])}},L=(s=[])=>{const a=f.filter(t=>t.turma_id===r).map(t=>{const i=s.find(x=>x.aluno_id===t.id);return{alunoId:t.id,presente:i?i.presente:!0,justificativa:""}});o(a)},M=s=>{o(n=>n.map(a=>({...a,presente:s}))),$(s?"todos-presentes":"todos-ausentes"),setTimeout(()=>$(null),1e3)},v=(s,n)=>{o(a=>a.map(t=>t.alunoId===s?{...t,presente:n}:t))},se=async()=>{if(!c){alert("Selecione uma disciplina antes de salvar as presen√ßas");return}C(!0);try{const{createPresenca:s,updatePresenca:n}=await N(async()=>{const{createPresenca:i,updatePresenca:x}=await import("./index-BJRSlDEO.js").then(h=>h.aq);return{createPresenca:i,updatePresenca:x}},__vite__mapDeps([0,1]));let a=0,t=0;for(const i of g){const x=J.find(h=>h.aluno_id===i.alunoId);try{x?await n(x.id,{presente:i.presente}):await s({aluno_id:i.alunoId,data_aula:d,presente:i.presente,disciplina_id:c}),a++}catch(h){console.error(`Erro ao salvar presen√ßa do aluno ${i.alunoId}:`,h),t++}}alert(t===0?`‚úÖ Todas as presen√ßas foram salvas com sucesso! (${a} registros)`:`‚ö†Ô∏è Presen√ßas salvas com alguns erros: ${a} sucessos, ${t} erros`),await I()}catch(s){console.error("Erro ao salvar presen√ßas:",s),alert("‚ùå Erro geral ao salvar presen√ßas: "+s.message)}finally{C(!1)}},m=f.filter(s=>s.turma_id===r),R=g.filter(s=>s.presente).length,ae=g.filter(s=>!s.presente).length;return Q?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg",children:e.jsx(y,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:"‚úÖ Controle de Presen√ßa"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Sistema r√°pido e eficiente"})]}),e.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl text-sm font-black shadow-lg",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"‚ö° Sistema R√°pido"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:r&&c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>W(!p),className:`px-4 py-2 rounded-lg transition-colors ${p?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:p?"Modo Normal":"Modo R√°pido"}),e.jsxs("button",{onClick:se,disabled:E,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 shadow-lg",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:E?"Salvando...":"Salvar Presen√ßas"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ie,{className:"h-5 w-5 text-gray-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Sele√ß√£o"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Turma"}),e.jsxs("select",{value:r,onChange:s=>{_(s.target.value),j(""),o([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione uma turma"}),b.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disciplina"}),e.jsxs("select",{value:c,onChange:s=>{j(s.target.value),o([])},disabled:!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r?"":"bg-gray-50 cursor-not-allowed"}`,children:[e.jsx("option",{value:"",children:"Selecione uma disciplina"}),T.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Aula"}),e.jsx("input",{type:"date",value:d,onChange:s=>{H(s.target.value),o([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})]}),r&&e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:(B=b.find(s=>s.id===r))==null?void 0:B.nome})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:(U=T.find(s=>s.id===c))==null?void 0:U.nome})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:new Date(d).toLocaleDateString("pt-BR")})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-xl border-2 border-gray-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-gray-600 uppercase tracking-wide",children:"üë• Total"}),e.jsx("p",{className:"text-3xl font-black text-gray-700",children:m.length})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-gray-400 to-gray-600 rounded-2xl shadow-lg",children:e.jsx(w,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-green-50 rounded-2xl shadow-xl border-2 border-green-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-green-600 uppercase tracking-wide",children:"‚úÖ Presentes"}),e.jsx("p",{className:"text-3xl font-black text-green-700",children:R})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl shadow-lg",children:e.jsx(k,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-red-50 rounded-2xl shadow-xl border-2 border-red-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-red-600 uppercase tracking-wide",children:"‚ùå Ausentes"}),e.jsx("p",{className:"text-3xl font-black text-red-700",children:ae})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-red-400 to-red-600 rounded-2xl shadow-lg",children:e.jsx(S,{className:"h-8 w-8 text-white"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl border-2 border-blue-200 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-110",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-blue-600 uppercase tracking-wide",children:"üìä % Presen√ßa"}),e.jsxs("p",{className:"text-3xl font-black text-blue-700",children:[m.length>0?Math.round(R/m.length*100):0,"%"]})]}),e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl shadow-lg",children:e.jsx(y,{className:"h-8 w-8 text-white"})})]})})]}),c&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Lista de Chamada - ",(q=b.find(s=>s.id===r))==null?void 0:q.nome]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>M(!0),className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-all ${A==="todos-presentes"?"bg-green-200 text-green-800 scale-105":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Todos Presentes"})]}),e.jsxs("button",{onClick:()=>M(!1),className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-all ${A==="todos-ausentes"?"bg-red-200 text-red-800 scale-105":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{children:"Todos Ausentes"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(d).toLocaleDateString("pt-BR")})]})]})]})}),e.jsx("div",{className:"p-6",children:m.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(w,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Nenhum aluno encontrado nesta turma"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>{const n=g.find(t=>t.alunoId===s.id),a=n==null?void 0:n.presente;return e.jsxs("div",{className:`flex items-center justify-between p-4 border-2 rounded-lg transition-all hover:shadow-md ${a===!0?"border-green-200 bg-green-50":a===!1?"border-red-200 bg-red-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg ${a===!0?"bg-green-500":a===!1?"bg-red-500":"bg-blue-500"}`,children:s.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:s.nome}),e.jsx("p",{className:"text-sm text-gray-500",children:a===!0?"‚úÖ Presente":a===!1?"‚ùå Ausente":"‚è≥ Aguardando"})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:p?e.jsx("button",{onClick:()=>v(s.id,!a),className:`flex items-center space-x-2 px-6 py-3 rounded-xl font-bold text-lg transition-all transform hover:scale-105 ${a?"bg-green-500 text-white hover:bg-green-600 shadow-lg":"bg-red-500 text-white hover:bg-red-600 shadow-lg"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-5 w-5"}),e.jsx("span",{children:"Presente"})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-5 w-5"}),e.jsx("span",{children:"Ausente"})]})}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>v(s.id,!0),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all transform hover:scale-105 ${a===!0?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-green-100 hover:text-green-700"}`,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Presente"})]}),e.jsxs("button",{onClick:()=>v(s.id,!1),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all transform hover:scale-105 ${a===!1?"bg-red-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-red-100 hover:text-red-700"}`,children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:"Ausente"})]})]})})]},s.id)})})})]}),!c&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecione uma disciplina"}),e.jsx("p",{className:"text-gray-500",children:"Escolha uma disciplina para fazer a chamada dos alunos de forma r√°pida e pr√°tica."})]})]}),!r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecione uma turma"}),e.jsx("p",{className:"text-gray-500",children:"Escolha uma turma e data para fazer a chamada dos alunos de forma eficiente."})]})]})}export{me as P,ce as U,de as a};
